!function(){var e=function(e){var t;return function(r){return t||e(t={exports:{},parent:r},t.exports),t.exports}},t=e(function(e,t){var r=1e3,n=6e4,i=36e5,o=24*i;function s(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var a,c,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&isFinite(e))return t.long?(a=e,(c=Math.abs(a))>=o?s(a,c,o,"day"):c>=i?s(a,c,i,"hour"):c>=n?s(a,c,n,"minute"):c>=r?s(a,c,r,"second"):a+" ms"):function(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+"d":t>=i?Math.round(e/i)+"h":t>=n?Math.round(e/n)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}),r=e(function(e,t){"use strict";var r,i,o,s,a=Object.prototype.isPrototypeOf,c=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(e,t){if(je(e),null===t||Ge(t))return e;throw new TypeError("Prototype must be null or an object")},e.exports=(i=function(){var e,t=Object.create(null),r={},n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(n){try{(e=n.set).call(t,r)}catch(i){}if(Object.getPrototypeOf(t)===r)return{set:e,level:2}}return t.__proto__=r,Object.getPrototypeOf(t)===r?{level:2}:((t={}).__proto__=r,Object.getPrototypeOf(t)===r&&{level:1})}())?(2===i.level?i.set?(s=i.set,o=function(e,t){return s.call(r(e,t),t),e}):o=function(e,t){return r(e,t).__proto__=t,e}:o=function e(t,n){var i;return r(t,n),(i=a.call(e.nullPolyfill,t))&&delete e.nullPolyfill.__proto__,null===n&&(n=e.nullPolyfill),t.__proto__=n,i&&c(e.nullPolyfill,"__proto__",u),t},Object.defineProperty(o,"level",{configurable:!1,enumerable:!1,writable:!1,value:i.level})):null,n({})}),n=e(function(e,t){"use strict";var n,i,o,s,a=Object.create;$e()||(n=r({})),e.exports=n?1!==n.level?a:(i={},o={},s={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){o[e]="__proto__"!==e?s:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(i,o),Object.defineProperty(n,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:i}),function(e,t){return a(null===e?i:e,t)}):a}),i=e(function(e,t){(function(t,r){"use strict";var n;e.exports=g,g.ReadableState=d,l.EventEmitter;var i=function(e,t){return e.listeners(t).length},a=re.Buffer,c=r.Uint8Array||function(){},u=Object.create(ce);u.inherits=ue;var h,f=void 0;f=le&&le.debuglog?le.debuglog("stream"):function(){},u.inherits(g,K);var p=["error","close","destroy","pause","resume"];function d(e,t){e=e||{};var r=t instanceof(n=n||s({}));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,a=e.readableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:c,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new he,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=o({}).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function g(e){if(n=n||s({}),!(this instanceof g))return new g(e);this._readableState=new d(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),K.call(this)}function y(e,t,r,n,i){var o,s=e._readableState;return null===t?(s.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,v(e)}}(e,s)):(i||(o=function(e,t){var r,n;return n=t,a.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):_(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?_(e,s,t,!1):S(e,s)):_(e,s,t,!1))):n||(s.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function _(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&v(e)),S(e,t)}Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),g.prototype.destroy=de.destroy,g.prototype._undestroy=de.undestroy,g.prototype._destroy=function(e,t){this.push(null),t(e)},g.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),r=!0),y(this,e,t,!1,r)},g.prototype.unshift=function(e){return y(this,e,null,!0,!1)},g.prototype.isPaused=function(){return!1===this._readableState.flowing},g.prototype.setEncoding=function(e){return h||(h=o({}).StringDecoder),this._readableState.decoder=new h(e),this._readableState.encoding=e,this};var b=8388608;function m(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=b?e=b:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function v(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?z.nextTick(w,e):w(e))}function w(e){f("emit readable"),e.emit("readable"),C(e)}function S(e,t){t.readingMore||(t.readingMore=!0,z.nextTick(k,e,t))}function k(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function E(e){f("readable nexttick read 0"),e.read(0)}function I(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),C(e),t.flowing&&!t.reading&&e.read(0)}function C(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0==(e-=s)){s===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=a.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0==(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}(e,t),n}(e,t.buffer,t.decoder),r);var r}function A(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,z.nextTick(P,t,e))}function P(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function T(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}g.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?A(this):v(this),null;if(0===(e=m(e,t))&&t.ended)return 0===t.length&&A(this),null;var n,i=t.needReadable;return f("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",i=!0),t.ended||t.reading?f("reading or ended",i=!1):i&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=m(r,t))),null===(n=e>0?O(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&A(this)),null!==n&&this.emit("data",n),n},g.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},g.prototype.pipe=function(e,r){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,f("pipe count=%d opts=%j",o.pipesCount,r);var s=r&&!1===r.end||e===t.stdout||e===t.stderr?y:a;function a(){f("onend"),e.end()}o.endEmitted?z.nextTick(s):n.once("end",s),e.on("unpipe",function t(r,i){f("onunpipe"),r===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,f("cleanup"),e.removeListener("close",d),e.removeListener("finish",g),e.removeListener("drain",c),e.removeListener("error",p),e.removeListener("unpipe",t),n.removeListener("end",a),n.removeListener("end",y),n.removeListener("data",h),u=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||c())});var c=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,C(e))}}(n);e.on("drain",c);var u=!1,l=!1;function h(t){f("ondata"),l=!1,!1!==e.write(t)||l||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==T(o.pipes,e))&&!u&&(f("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,l=!0),n.pause())}function p(t){f("onerror",t),y(),e.removeListener("error",p),0===i(e,"error")&&e.emit("error",t)}function d(){e.removeListener("finish",g),y()}function g(){f("onfinish"),e.removeListener("close",d),y()}function y(){f("unpipe"),n.unpipe(e)}return n.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener("error",r);e._events&&e._events.error?H(e._events.error)?e._events.error.unshift(r):e._events.error=[r,e._events.error]:e.on("error",r)}(e,0,p),e.once("close",d),e.once("finish",g),e.emit("pipe",n),o.flowing||(f("pipe resume"),n.resume()),e},g.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var s=T(t.pipes,e);return-1===s?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},g.prototype.on=function(e,t){var r=K.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&v(this):z.nextTick(E,this))}return r},g.prototype.addListener=g.prototype.on,g.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,z.nextTick(I,e,t))}(this,e)),this},g.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},g.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(f("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){f("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<p.length;o++)e.on(p[o],this.emit.bind(this,p[o]));return this._read=function(t){f("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(g.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),g._fromList=O}).call(this,P,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}),o=e(function(e,t){"use strict";var r=re.Buffer,n=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=a,this.end=c,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=u,this.end=l,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function a(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=i,i.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},i.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},i.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=o(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},i.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}}),s=e(function(e,t){"use strict";var r=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=h;var n=Object.create(ce);n.inherits=ue;var o=i({}),s=a({});n.inherits(h,o);for(var c=r(s.prototype),u=0;u<c.length;u++){var l=c[u];h.prototype[l]||(h.prototype[l]=s.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||z.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),z.nextTick(t,e)}}),a=e(function(e,t){(function(t,r,n){"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(void 0),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=g;var o,a=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:z.nextTick;g.WritableState=d;var c=Object.create(ce);c.inherits=ue;var u,l={deprecate:ge},h=re.Buffer,f=r.Uint8Array||function(){};function p(){}function d(e,t){o=o||s({}),e=e||{};var r=t instanceof o;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,c=e.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(c||0===c)?c:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===e.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(z.nextTick(i,n),z.nextTick(w,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),w(e,t))}(e,r,n,t,i);else{var o=m(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||b(e,r),n?a(_,e,r,o,i):_(e,r,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function g(e){if(o=o||s({}),!(u.call(g,this)||this instanceof o))return new g(e);this._writableState=new d(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),K.call(this)}function y(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function _(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),w(e,t)}function b(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,o=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,c=!0;r;)o[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;o.allBuffers=c,y(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,h=r.callback;if(y(e,t,!1,t.objectMode?1:u.length,u,l,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function m(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function v(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),w(e,t)})}function w(e,t){var r=m(t);return r&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,z.nextTick(v,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}c.inherits(g,K),d.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(d.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===g&&e&&e._writableState instanceof d}})):u=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,r){var n,i=this._writableState,o=!1,s=!i.objectMode&&(n=e,h.isBuffer(n)||n instanceof f);return s&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(r=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=p),i.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),z.nextTick(t,r)}(this,r):(s||function(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),z.nextTick(n,o),i=!1),i}(this,i,e,r))&&(i.pendingcb++,o=function(e,t,r,n,i,o){if(!r){var s=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,r)),t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,a,n,i,o);return c}(this,i,s,e,t,r)),o},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,w(e,t),r&&(t.finished?z.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=de.destroy,g.prototype._undestroy=de.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,P,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},c({}).setImmediate)}),c=e(function(e,t){(function(e,r){var n=P.nextTick,i=(Function.prototype.apply,Array.prototype.slice),o={},s=0;function a(e,t){this._id=e,this._clearFn=t}a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},t.setImmediate="function"==typeof e?e:function(e){var r=s++,a=!(arguments.length<2)&&i.call(arguments,1);return o[r]=!0,n(function(){o[r]&&(a?e.apply(null,a):e.call(null),t.clearImmediate(r))}),r},t.clearImmediate="function"==typeof r?r:function(e){delete o[e]}}).call(this,c({}).setImmediate,c({}).clearImmediate)}),u=e(function(e,t){(function(e){"use strict";t.Buffer=e,t.SlowBuffer=function(t){return+t!=t&&(t=0),e.alloc(+t)},t.INSPECT_MAX_BYTES=50;var r=2147483647;function n(t){if(t>r)throw new RangeError('The value "'+t+'" is invalid for option "size"');var n=new Uint8Array(t);return n.__proto__=e.prototype,n}function e(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}return i(e,t,r)}function i(t,r,i){if("string"==typeof t)return function(t,r){if("string"==typeof r&&""!==r||(r="utf8"),!e.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i=0|u(t,r),o=n(i),s=o.write(t,r);return s!==i&&(o=o.slice(0,s)),o}(t,r);if(ArrayBuffer.isView(t))return a(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(R(t,ArrayBuffer)||t&&R(t.buffer,ArrayBuffer))return function(t,r,n){if(r<0||t.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<r+(n||0))throw new RangeError('"length" is outside of buffer bounds');var i;return(i=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n)).__proto__=e.prototype,i}(t,r,i);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var o=t.valueOf&&t.valueOf();if(null!=o&&o!==t)return e.from(o,r,i);var s=function(t){if(e.isBuffer(t)){var r=0|c(t.length),i=n(r);return 0===i.length?i:(t.copy(i,0,0,r),i)}return void 0!==t.length?"number"!=typeof t.length||U(t.length)?n(0):a(t):"Buffer"===t.type&&Array.isArray(t.data)?a(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return e.from(t[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function s(e){return o(e),n(e<0?0:0|c(e))}function a(e){for(var t=e.length<0?0:0|c(e.length),r=n(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function c(e){if(e>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|e}function u(t,r){if(e.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||R(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var o=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return M(t).length;default:if(o)return i?-1:j(t).length;r=(""+r).toLowerCase(),o=!0}}function l(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function h(t,r,n,i,o){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),U(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof r&&(r=e.from(r,i)),e.isBuffer(r))return 0===r.length?-1:f(t,r,n,i,o);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,r,n):Uint8Array.prototype.lastIndexOf.call(t,r,n):f(t,[r],n,i,o);throw new TypeError("val must be string, number or Buffer")}function f(e,t,r,n,i){var o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var h=!0,f=0;f<c;f++)if(u(e,o+f)!==u(t,f)){h=!1;break}if(h)return o}return-1}function p(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(U(a))return s;e[r+s]=a}return s}function d(e,t,r,n){return B(j(t,e.length-r),e,r,n)}function g(e,t,r,n){return B(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function y(e,t,r,n){return g(e,t,r,n)}function _(e,t,r,n){return B(M(t),e,r,n)}function b(e,t,r,n){return B(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function m(e,t,r){return 0===t&&r===e.length?V.fromByteArray(e):V.fromByteArray(e.slice(t,r))}function v(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,c,u=e[i],l=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=h}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=w));return r}(n)}t.kMaxLength=r,e.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(t){return!1}}(),e.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(e,t,r){return i(e,t,r)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(e,t,r){return function(e,t,r){return o(e),e<=0?n(e):void 0!==t?"string"==typeof r?n(e).fill(t,r):n(e).fill(t):n(e)}(e,t,r)},e.allocUnsafe=function(e){return s(e)},e.allocUnsafeSlow=function(e){return s(e)},e.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==e.prototype},e.compare=function(t,r){if(R(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),R(r,Uint8Array)&&(r=e.from(r,r.offset,r.byteLength)),!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;for(var n=t.length,i=r.length,o=0,s=Math.min(n,i);o<s;++o)if(t[o]!==r[o]){n=t[o],i=r[o];break}return n<i?-1:i<n?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return e.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<t.length;++n)r+=t[n].length;var i=e.allocUnsafe(r),o=0;for(n=0;n<t.length;++n){var s=t[n];if(R(s,Uint8Array)&&(s=e.from(s)),!e.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,o),o+=s.length}return i},e.byteLength=u,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)l(this,t,t+1);return this},e.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)l(this,t,t+3),l(this,t+1,t+2);return this},e.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)l(this,t,t+7),l(this,t+1,t+6),l(this,t+2,t+5),l(this,t+3,t+4);return this},e.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?v(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,r);case"utf8":case"utf-8":return v(this,t,r);case"ascii":return S(this,t,r);case"latin1":case"binary":return k(this,t,r);case"base64":return m(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===e.compare(this,t)},e.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},e.prototype.compare=function(t,r,n,i,o){if(R(t,Uint8Array)&&(t=e.from(t,t.offset,t.byteLength)),!e.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===r&&(r=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),r<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(this===t)return 0;for(var s=(o>>>=0)-(i>>>=0),a=(n>>>=0)-(r>>>=0),c=Math.min(s,a),u=this.slice(i,o),l=t.slice(r,n),h=0;h<c;++h)if(u[h]!==l[h]){s=u[h],a=l[h];break}return s<a?-1:a<s?1:0},e.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},e.prototype.indexOf=function(e,t,r){return h(this,e,t,r,!0)},e.prototype.lastIndexOf=function(e,t,r){return h(this,e,t,r,!1)},e.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return p(this,e,t,r);case"utf8":case"utf-8":return d(this,e,t,r);case"ascii":return g(this,e,t,r);case"latin1":case"binary":return y(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function S(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function k(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function E(e,t,r){var n,i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var o="",s=t;s<r;++s)o+=(n=e[s])<16?"0"+n.toString(16):n.toString(16);return o}function I(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function C(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,r,n,i,o,s){if(!e.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>o||r<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function A(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function P(e,t,r,n,i){return t=+t,r>>>=0,i||A(e,0,r,4),te.write(e,t,r,n,23,4),r+4}function T(e,t,r,n,i){return t=+t,r>>>=0,i||A(e,0,r,8),te.write(e,t,r,n,52,8),r+8}e.prototype.slice=function(t,r){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t);var i=this.subarray(t,r);return i.__proto__=e.prototype,i},e.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},e.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},e.prototype.readUInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return e>>>=0,t||C(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||C(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},e.prototype.readInt8=function(e,t){return e>>>=0,t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){e>>>=0,t||C(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(e,t){e>>>=0,t||C(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return e>>>=0,t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return e>>>=0,t||C(e,4,this.length),te.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return e>>>=0,t||C(e,4,this.length),te.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return e>>>=0,t||C(e,8,this.length),te.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return e>>>=0,t||C(e,8,this.length),te.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},e.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},e.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,255,0),this[t]=255&e,t+1},e.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},e.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},e.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},e.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},e.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},e.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},e.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},e.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},e.prototype.writeFloatLE=function(e,t,r){return P(this,e,t,!0,r)},e.prototype.writeFloatBE=function(e,t,r){return P(this,e,t,!1,r)},e.prototype.writeDoubleLE=function(e,t,r){return T(this,e,t,!0,r)},e.prototype.writeDoubleBE=function(e,t,r){return T(this,e,t,!1,r)},e.prototype.copy=function(t,r,n,i){if(!e.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),r>=t.length&&(r=t.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-r<i-n&&(i=t.length-r+n);var o=i-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,i);else if(this===t&&n<r&&r<i)for(var s=o-1;s>=0;--s)t[s+r]=this[s+n];else Uint8Array.prototype.set.call(t,this.subarray(n,i),r);return o},e.prototype.fill=function(t,r,n,i){if("string"==typeof t){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!e.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var o=t.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(t=o)}}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;var s;if(r>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=r;s<n;++s)this[s]=t;else{var a=e.isBuffer(t)?t:e.from(t,i),c=a.length;if(0===c)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=a[s%c]}return this};var x=/[^+/0-9A-Za-z-_]/g;function j(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function M(e){return V.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(x,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function B(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function R(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function U(e){return e!=e}}).call(this,u({}).Buffer)}),l={},h=Object.create||function(e){var t=function(){};return t.prototype=e,new t},f=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},p=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function d(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=h(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}l=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0;var g,y=10;try{var _={};Object.defineProperty&&Object.defineProperty(_,"x",{value:0}),g=0===_.x}catch(fo){g=!1}function b(e){return void 0===e._maxListeners?d.defaultMaxListeners:e._maxListeners}function m(e,t,r,n){var i,o,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]):(o=e._events=h(null),e._eventsCount=0),s){if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=b(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",a.name,a.message)}}else s=o[t]=r,++e._eventsCount;return e}function v(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function w(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=p.call(v,n);return i.listener=r,n.wrapFn=i,i}function S(e,t,r){var n=e._events;if(!n)return[];var i=n[t];return i?"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):E(i,i.length):[]}function k(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function E(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}g?Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return y},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');y=e}}):d.defaultMaxListeners=y,d.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},d.prototype.getMaxListeners=function(){return b(this)},d.prototype.emit=function(e){var t,r,n,i,o,s,a="error"===e;if(s=this._events)a=a&&null==s.error;else if(!a)return!1;if(a){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var c=new Error('Unhandled "error" event. ('+t+")");throw c.context=t,c}if(!(r=s[e]))return!1;var u="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=E(e,n),o=0;o<n;++o)i[o].call(r)}(r,u,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,o=E(e,i),s=0;s<i;++s)o[s].call(r,n)}(r,u,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var o=e.length,s=E(e,o),a=0;a<o;++a)s[a].call(r,n,i)}(r,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else for(var s=e.length,a=E(e,s),c=0;c<s;++c)a[c].call(r,n,i,o)}(r,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),o=1;o<n;o++)i[o-1]=arguments[o];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,o=E(e,i),s=0;s<i;++s)o[s].apply(r,n)}(r,u,this,i)}return!0},d.prototype.addListener=function(e,t){return m(this,e,t,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(e,t){return m(this,e,t,!0)},d.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,w(this,e,t)),this},d.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,w(this,e,t)),this},d.prototype.removeListener=function(e,t){var r,n,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=h(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(var r=i,n=r+1,o=e.length;n<o;r+=1,n+=1)e[r]=e[n];e.pop()}(r),1===r.length&&(n[e]=r[0]),n.removeListener&&this.emit("removeListener",e,s||t)}return this},d.prototype.removeAllListeners=function(e){var t,r,n;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=h(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=h(null):delete r[e]),this;if(0===arguments.length){var i,o=f(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=h(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},d.prototype.listeners=function(e){return S(this,e,!0)},d.prototype.rawListeners=function(e){return S(this,e,!1)},d.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):k.call(e,t)},d.prototype.listenerCount=k,d.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var I,C,O=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var n in r)A.call(r,n)&&(e[n]=r[n])}return e},A=Object.prototype.hasOwnProperty,P={},T=P={};function x(){throw new Error("setTimeout has not been defined")}function j(){throw new Error("clearTimeout has not been defined")}function M(e){if(I===setTimeout)return setTimeout(e,0);if((I===x||!I)&&setTimeout)return I=setTimeout,setTimeout(e,0);try{return I(e,0)}catch(t){try{return I.call(null,e,0)}catch(t){return I.call(this,e,0)}}}!function(){try{I="function"==typeof setTimeout?setTimeout:x}catch(e){I=x}try{C="function"==typeof clearTimeout?clearTimeout:j}catch(e){C=j}}();var B,R=[],U=!1,N=-1;function L(){U&&B&&(U=!1,B.length?R=B.concat(R):N=-1,R.length&&q())}function q(){if(!U){var e=M(L);U=!0;for(var t=R.length;t;){for(B=R,R=[];++N<t;)B&&B[N].run();N=-1,t=R.length}B=null,U=!1,function(e){if(C===clearTimeout)return clearTimeout(e);if((C===j||!C)&&clearTimeout)return C=clearTimeout,clearTimeout(e);try{C(e)}catch(t){try{return C.call(null,e)}catch(t){return C.call(this,e)}}}(e)}}function F(e,t){this.fun=e,this.array=t}function D(){}T.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];R.push(new F(e,t)),1!==R.length||U||M(q)},F.prototype.run=function(){this.fun.apply(null,this.array)},T.title="browser",T.browser=!0,T.env={},T.argv=[],T.version="",T.versions={},T.on=D,T.addListener=D,T.once=D,T.off=D,T.removeListener=D,T.removeAllListeners=D,T.emit=D,T.prependListener=D,T.prependOnceListener=D,T.listeners=function(e){return[]},T.binding=function(e){throw new Error("process.binding is not supported")},T.cwd=function(){return"/"},T.chdir=function(e){throw new Error("process.chdir is not supported")},T.umask=function(){return 0};var z={};(function(e){"use strict";z=void 0===e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?{nextTick:function(t,r,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,r)});case 3:return e.nextTick(function(){t.call(null,r,n)});case 4:return e.nextTick(function(){t.call(null,r,n,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return e.nextTick(function(){t.apply(null,o)})}}}:e}).call(this,P);for(var W={}.toString,H=Array.isArray||function(e){return"[object Array]"==W.call(e)},K=l.EventEmitter,V={toByteArray:function(e){var t,r,n=X(e),i=n[0],o=n[1],s=new Z(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),a=0,c=o>0?i-4:i;for(r=0;r<c;r+=4)t=$[e.charCodeAt(r)]<<18|$[e.charCodeAt(r+1)]<<12|$[e.charCodeAt(r+2)]<<6|$[e.charCodeAt(r+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;return 2===o&&(t=$[e.charCodeAt(r)]<<2|$[e.charCodeAt(r+1)]>>4,s[a++]=255&t),1===o&&(t=$[e.charCodeAt(r)]<<10|$[e.charCodeAt(r+1)]<<4|$[e.charCodeAt(r+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t),s},fromByteArray:function(e){for(var t,r=e.length,n=r%3,i=[],o=0,s=r-n;o<s;o+=16383)i.push(ee(e,o,o+16383>s?s:o+16383));return 1===n?(t=e[r-1],i.push(Q[t>>2]+Q[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(Q[t>>10]+Q[t>>4&63]+Q[t<<2&63]+"=")),i.join("")}},Q=[],$=[],Z="undefined"!=typeof Uint8Array?Uint8Array:Array,G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",J=0,Y=G.length;J<Y;++J)Q[J]=G[J],$[G.charCodeAt(J)]=J;function X(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function ee(e,t,r){for(var n,i,o=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(Q[(i=n)>>18&63]+Q[i>>12&63]+Q[i>>6&63]+Q[63&i]);return o.join("")}$["-".charCodeAt(0)]=62,$["_".charCodeAt(0)]=63;var te={read:function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,h=r?i-1:0,f=r?-1:1,p=e[t+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+h],h+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=u}return(p?-1:1)*s*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+p]=255&s,p+=d,s/=256,u-=8);e[r+p-d]|=128*g}},re={},ne=u({}),ie=ne.Buffer;function oe(e,t){for(var r in e)t[r]=e[r]}function se(e,t,r){return ie(e,t,r)}function ae(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}ie.from&&ie.alloc&&ie.allocUnsafe&&ie.allocUnsafeSlow?re=ne:(oe(ne,re),re.Buffer=se),oe(ie,se),se.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return ie(e,t,r)},se.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=ie(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},se.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return ie(e)},se.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return ne.SlowBuffer(e)};var ce={};(function(e){function t(e){return Object.prototype.toString.call(e)}ce.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},ce.isBoolean=function(e){return"boolean"==typeof e},ce.isNull=function(e){return null===e},ce.isNullOrUndefined=function(e){return null==e},ce.isNumber=function(e){return"number"==typeof e},ce.isString=function(e){return"string"==typeof e},ce.isSymbol=function(e){return"symbol"==typeof e},ce.isUndefined=function(e){return void 0===e},ce.isRegExp=function(e){return"[object RegExp]"===t(e)},ce.isObject=function(e){return"object"==typeof e&&null!==e},ce.isDate=function(e){return"[object Date]"===t(e)},ce.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},ce.isFunction=function(e){return"function"==typeof e},ce.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},ce.isBuffer=e.isBuffer}).call(this,{isBuffer:function(e){return null!=e&&(ae(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&ae(e.slice(0,0))}(e)||!!e._isBuffer)}});var ue={};ue="function"==typeof Object.create?function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}};var le={},he={},fe=re.Buffer;function pe(e,t){e.emit("error",t)}he=function(){function e(){!function(t,r){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return fe.alloc(0);if(1===this.length)return this.head.data;for(var t,r,n=fe.allocUnsafe(e>>>0),i=this.head,o=0;i;)t=n,r=o,i.data.copy(t,r),o+=i.data.length,i=i.next;return n},e}(),le&&le.inspect&&le.inspect.custom&&(he.prototype[le.inspect.custom]=function(){var e=le.inspect({length:this.length});return this.constructor.name+" "+e});var de={destroy:function(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||z.nextTick(pe,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(z.nextTick(pe,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}},ge={};(function(e){function t(t){try{if(!e.localStorage)return!1}catch(n){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}ge=function(e,r){if(t("noDeprecation"))return e;var n=!1;return function(){if(!n){if(t("throwDeprecation"))throw new Error(r);t("traceDeprecation")?console.trace(r):console.warn(r),n=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ye=ve,_e=s({}),be=Object.create(ce);function me(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function ve(e){if(!(this instanceof ve))return new ve(e);_e.call(this,e),this._transformState={afterTransform:me.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",we)}function we(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){Se(e,t,r)}):Se(this,null,null)}function Se(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}be.inherits=ue,be.inherits(ve,_e),ve.prototype.push=function(e,t){return this._transformState.needTransform=!1,_e.prototype.push.call(this,e,t)},ve.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},ve.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},ve.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},ve.prototype._destroy=function(e,t){var r=this;_e.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})};var ke=Ie,Ee=Object.create(ce);function Ie(e){if(!(this instanceof Ie))return new Ie(e);ye.call(this,e)}Ee.inherits=ue,Ee.inherits(Ie,ye),Ie.prototype._transform=function(e,t,r){r(null,e)};var Ce={};(Ce=Ce=i({})).Stream=Ce,Ce.Readable=Ce,Ce.Writable=a({}),Ce.Duplex=s({}),Ce.Transform=ye,Ce.PassThrough=ke;var Oe,Ae,Pe,Te,xe=function(e){return null!=e},je=function(e){if(!xe(e))throw new TypeError("Cannot use null or undefined");return e},Me=function(){return je(this).length=0,this},Be="function"!=typeof(Oe=Number.isNaN)||Oe({})||!Oe(NaN)||Oe(34)?function(e){return e!=e}:Number.isNaN,Re="function"==typeof(Ae=Math.sign)&&1===Ae(10)&&-1===Ae(-20)?Math.sign:function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1},Ue=Math.abs,Ne=Math.floor,Le=Math.max,qe=function(e){return Le(0,function(e){return isNaN(e)?0:0!==(e=Number(e))&&isFinite(e)?Re(e)*Ne(Ue(e)):e}(e))},Fe=Array.prototype.indexOf,De=Object.prototype.hasOwnProperty,ze=Math.abs,We=Math.floor,He=function(e){var t,r,n,i;if(!Be(e))return Fe.apply(this,arguments);for(r=qe(je(this).length),n=arguments[1],t=n=isNaN(n)?0:n>=0?We(n):qe(this.length)-We(ze(n));t<r;++t)if(De.call(this,t)&&(i=this[t],Be(i)))return t;return-1},Ke=Object.create,Ve=Object.getPrototypeOf,Qe={},$e=function(){var e=Object.setPrototypeOf,t=arguments[0]||Ke;return"function"==typeof e&&Ve(e(t(null),Qe))===Qe},Ze={function:!0,object:!0},Ge=function(e){return xe(e)&&Ze[typeof e]||!1},Je=$e()?Object.setPrototypeOf:r({}),Ye=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},Xe=function(e){return null!=e},et={object:!0,function:!0,undefined:!0},tt=function(e){return!!Xe(e)&&hasOwnProperty.call(et,typeof e)},rt=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(t){return!1}return!function(e){if(!tt(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(t){return!1}}(e)},nt=/^\s*class[\s{/}]/,it=Function.prototype.toString,ot=function(e){return!!rt(e)&&!nt.test(it.call(e))},st=Object.keys,at=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}()?Object.keys:function(e){return st(xe(e)?Object(e):e)},ct=Math.max,ut="function"==typeof(Te=Object.assign)&&(Te(Pe={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),Pe.foo+Pe.bar+Pe.trzy==="razdwatrzy")?Object.assign:function(e,t){var r,n,i,o=ct(arguments.length,2);for(e=Object(je(e)),i=function(n){try{e[n]=t[n]}catch(i){r||(r=i)}},n=1;n<o;++n)t=arguments[n],at(t).forEach(i);if(void 0!==r)throw r;return e},lt=Array.prototype.forEach,ht=Object.create,ft=function(e){var t=ht(null);return lt.call(arguments,function(e){xe(e)&&function(e,t){var r;for(r in e)t[r]=e[r]}(Object(e),t)}),t},pt="razdwatrzy",dt=String.prototype.indexOf,gt="function"==typeof pt.contains&&!0===pt.contains("dwa")&&!1===pt.contains("foo")?String.prototype.contains:function(e){return dt.call(this,e,arguments[1])>-1},yt={};(yt=function(e,t){var r,n,i,o,s;return arguments.length<2||"string"!=typeof e?(o=t,t=e,e=null):o=arguments[2],Xe(e)?(r=gt.call(e,"c"),n=gt.call(e,"e"),i=gt.call(e,"w")):(r=i=!0,n=!1),s={value:t,configurable:r,enumerable:n,writable:i},o?ut(ft(o),s):s}).gs=function(e,t,r){var n,i,o,s;return"string"!=typeof e?(o=r,r=t,t=e,e=null):o=arguments[3],Xe(t)?ot(t)?Xe(r)?ot(r)||(o=r,r=void 0):r=void 0:(o=t,t=r=void 0):t=void 0,Xe(e)?(n=gt.call(e,"c"),i=gt.call(e,"e")):(n=!0,i=!1),s={get:t,set:r,configurable:n,enumerable:i},o?ut(ft(o),s):s};var _t,bt,mt,vt,wt,St,kt,Et={},It=Function.prototype.apply,Ct=Function.prototype.call,Ot=Object.create,At=Object.defineProperty,Pt=Object.defineProperties,Tt=Object.prototype.hasOwnProperty,xt={configurable:!0,enumerable:!1,writable:!0};bt=function(e,t){var r,n;return Ye(t),n=this,_t.call(this,e,r=function(){mt.call(n,e,r),It.call(t,this,arguments)}),r.__eeOnceListener__=t,this},wt={on:_t=function(e,t){var r;return Ye(t),Tt.call(this,"__ee__")?r=this.__ee__:(r=xt.value=Ot(null),At(this,"__ee__",xt),xt.value=null),r[e]?"object"==typeof r[e]?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},once:bt,off:mt=function(e,t){var r,n,i,o;if(Ye(t),!Tt.call(this,"__ee__"))return this;if(!(r=this.__ee__)[e])return this;if("object"==typeof(n=r[e]))for(o=0;i=n[o];++o)i!==t&&i.__eeOnceListener__!==t||(2===n.length?r[e]=n[o?0:1]:n.splice(o,1));else n!==t&&n.__eeOnceListener__!==t||delete r[e];return this},emit:vt=function(e){var t,r,n,i,o;if(Tt.call(this,"__ee__")&&(i=this.__ee__[e]))if("object"==typeof i){for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];for(i=i.slice(),t=0;n=i[t];++t)It.call(n,this,o)}else switch(arguments.length){case 1:Ct.call(i,this);break;case 2:Ct.call(i,this,arguments[1]);break;case 3:Ct.call(i,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),t=1;t<r;++t)o[t-1]=arguments[t];It.call(i,this,o)}}},St={on:yt(_t),once:yt(bt),off:yt(mt),emit:yt(vt)},kt=Pt({},St),(Et=Et=function(e){return null==e?Ot(kt):Pt(Object(e),St)}).methods=wt;var jt,Mt,Bt,Rt,Ut=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")},Nt=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return Ut()}try{return __global__||Ut()}finally{delete Object.prototype.__global__}}(),Lt="object"==typeof globalThis&&globalThis&&globalThis.Array===Array?globalThis:Nt,qt={object:!0,symbol:!0},Ft=function(e){if(!function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}(e))throw new TypeError(e+" is not a symbol");return e},Dt=Object.create,zt=Object.defineProperty,Wt=Object.prototype,Ht=Dt(null),Kt=function(e){for(var t,r,n=0;Ht[e+(n||"")];)++n;return Ht[e+=n||""]=!0,zt(Wt,t="@@"+e,yt.gs(null,function(e){r||(r=!0,zt(this,t,yt(e)),r=!1)})),t},Vt=Lt.Symbol,Qt=Object.create(null),$t=Lt.Symbol,Zt=Object.create,Gt=Object.defineProperties,Jt=Object.defineProperty;if("function"==typeof $t)try{String($t()),Rt=!0}catch(po){}else $t=null;Bt=function(e){if(this instanceof Bt)throw new TypeError("Symbol is not a constructor");return Mt(e)},jt=Mt=function e(t){var r;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return Rt?$t(t):(r=Zt(Bt.prototype),t=void 0===t?"":String(t),Gt(r,{__description__:yt("",t),__name__:yt("",Kt(t))}))},function(e){Object.defineProperties(e,{hasInstance:yt("",Vt&&Vt.hasInstance||e("hasInstance")),isConcatSpreadable:yt("",Vt&&Vt.isConcatSpreadable||e("isConcatSpreadable")),iterator:yt("",Vt&&Vt.iterator||e("iterator")),match:yt("",Vt&&Vt.match||e("match")),replace:yt("",Vt&&Vt.replace||e("replace")),search:yt("",Vt&&Vt.search||e("search")),species:yt("",Vt&&Vt.species||e("species")),split:yt("",Vt&&Vt.split||e("split")),toPrimitive:yt("",Vt&&Vt.toPrimitive||e("toPrimitive")),toStringTag:yt("",Vt&&Vt.toStringTag||e("toStringTag")),unscopables:yt("",Vt&&Vt.unscopables||e("unscopables"))})}(Mt),function(e){Object.defineProperties(e,{for:yt(function(t){return Qt[t]?Qt[t]:Qt[t]=e(String(t))}),keyFor:yt(function(e){var t;for(t in Ft(e),Qt)if(Qt[t]===e)return t})})}(Mt),Gt(Bt.prototype,{constructor:yt(Mt),toString:yt("",function(){return this.__name__})}),Gt(Mt.prototype,{toString:yt(function(){return"Symbol ("+Ft(this).__description__+")"}),valueOf:yt(function(){return Ft(this)})}),Jt(Mt.prototype,Mt.toPrimitive,yt("",function(){var e=Ft(this);return"symbol"==typeof e?e:e.toString()})),Jt(Mt.prototype,Mt.toStringTag,yt("c","Symbol")),Jt(Bt.prototype,Mt.toStringTag,yt("c",Mt.prototype[Mt.toStringTag])),Jt(Bt.prototype,Mt.toPrimitive,yt("c",Mt.prototype[Mt.toPrimitive]));var Yt,Xt,er,tr,rr,nr,ir,or=function(){var e,t=Lt.Symbol;if("function"!=typeof t)return!1;e=t("test symbol");try{String(e)}catch(r){return!1}return!!qt[typeof t.iterator]&&!!qt[typeof t.toPrimitive]&&!!qt[typeof t.toStringTag]}()?Lt.Symbol:jt,sr=Object.prototype.toString,ar=sr.call(function(){return arguments}()),cr=function(e){return sr.call(e)===ar},ur=Object.prototype.toString,lr=ur.call(""),hr=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||ur.call(e)===lr)||!1},fr=or.iterator,pr=Array.isArray,dr=function(e){if(!function(e){return!(!xe(e)||!pr(e)&&!hr(e)&&!cr(e)&&"function"!=typeof e[fr])}(e))throw new TypeError(e+" is not iterable");return e},gr=Object.prototype.toString,yr=/[\n\r\u2028\u2029]/g,_r=function(e){var t=function(e){try{return e.toString()}catch(t){try{return String(e)}catch(r){return null}}}(e);return null===t?"<Non-coercible to string value>":(t.length>100&&(t=t.slice(0,99)+"\u2026"),t=t.replace(yr,function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))},br=function(e,t){return e.replace("%v",_r(t))},mr=function(e,t,r){if(!tt(r))throw new TypeError(br(t,e));if(!Xe(e)){if("default"in r)return r.default;if(r.isOptional)return null}var n=function(e){if(!Xe(e))return null;if(tt(e)){var t=e.toString;if("function"!=typeof t)return null;if(t===gr)return null}try{return""+e}catch(r){return null}}(r.errorMessage);throw Xe(n)||(n=t),new TypeError(br(n,e))},vr=function(e){return ot(e)?e:mr(e,"%v is not a plain function",arguments[1])},wr=Object.prototype.toString,Sr=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/),kr=or.iterator,Er=Array.isArray,Ir=Function.prototype.call,Cr={configurable:!0,enumerable:!0,writable:!0,value:null},Or=Object.defineProperty,Ar="function"==typeof(er=Array.from)&&(Xt=er(Yt=["raz","dwa"]),Boolean(Xt&&Xt!==Yt&&"dwa"===Xt[1]))?Array.from:function(e){var t,r,n,i,o,s,a,c,u,l,h=arguments[1],f=arguments[2];if(e=Object(je(e)),xe(h)&&Ye(h),this&&this!==Array&&function(e){return"function"==typeof e&&Sr(wr.call(e))}(this))t=this;else{if(!h){if(cr(e))return 1!==(o=e.length)?Array.apply(null,e):((i=new Array(1))[0]=e[0],i);if(Er(e)){for(i=new Array(o=e.length),r=0;r<o;++r)i[r]=e[r];return i}}i=[]}if(!Er(e))if(void 0!==(u=e[kr])){for(a=Ye(u).call(e),t&&(i=new t),c=a.next(),r=0;!c.done;)l=h?Ir.call(h,f,c.value,r):c.value,t?(Cr.value=l,Or(i,r,Cr)):i[r]=l,c=a.next(),++r;o=r}else if(hr(e)){for(o=e.length,t&&(i=new t),r=0,n=0;r<o;++r)l=e[r],r+1<o&&(s=l.charCodeAt(0))>=55296&&s<=56319&&(l+=e[++r]),l=h?Ir.call(h,f,l,n):l,t?(Cr.value=l,Or(i,n,Cr)):i[n]=l,++n;o=n}if(void 0===o)for(o=qe(e.length),t&&(i=new t(o)),r=0;r<o;++r)l=h?Ir.call(h,f,e[r],r):e[r],t?(Cr.value=l,Or(i,r,Cr)):i[r]=l;return t&&(Cr.value=null,i.length=o),i},Pr=Function.prototype.bind,Tr=Function.prototype.call,xr=Object.keys,jr=Object.prototype.propertyIsEnumerable,Mr=(tr="forEach",function(e,t){var r,n=arguments[2],i=arguments[3];return e=Object(je(e)),Ye(t),r=xr(e),i&&r.sort("function"==typeof i?Pr.call(i,e):void 0),"function"!=typeof tr&&(tr=r[tr]),Tr.call(tr,r,function(r,i){return jr.call(e,r)?Tr.call(t,n,e[r],r,e,i):rr})}),Br=Function.prototype.call,Rr=Function.prototype.bind,Ur=Object.defineProperty,Nr=Object.prototype.hasOwnProperty;ir=function(e,t,r){var n,i=function(e){return Xe(e)?e:mr(e,"Cannot use %v",arguments[1])}(t)&&vr(t.value);return delete(n=function(e){var t=Object(je(e)),r=arguments[1],n=Object(arguments[2]);if(t!==e&&!r)return t;var i={};return r?Ar(r,function(t){(n.ensure||t in e)&&(i[t]=e[t])}):ut(i,e),i}(t)).writable,delete n.value,n.get=function(){return!r.overwriteDefinition&&Nr.call(this,e)?i:(t.value=Rr.call(i,r.resolveContext?r.resolveContext(this):this),Ur(this,e,t),this[e])},n},nr=function(e){var t=ft(arguments[1]);return Xe(t.resolveContext)&&vr(t.resolveContext),function(e,t){var r={},n=arguments[2];return Ye(t),Mr(e,function(e,i,o,s){r[i]=Br.call(t,n,e,i,o,s)}),r}(e,function(e,r){return ir(r,e,t)})};var Lr,qr={},Fr=Object.defineProperty,Dr=Object.defineProperties;qr=Lr=function(e,t){if(!(this instanceof Lr))throw new TypeError("Constructor requires 'new'");Dr(this,{__list__:yt("w",je(e)),__context__:yt("w",t),__nextIndex__:yt("w",0)}),t&&(Ye(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete Lr.prototype.constructor,Dr(Lr.prototype,ut({_next:yt(function(){var e;if(this.__list__)return this.__redo__&&void 0!==(e=this.__redo__.shift())?e:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:yt(function(){return this._createResult(this._next())}),_createResult:yt(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:yt(function(e){return this.__list__[e]}),_unBind:yt(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:yt(function(){return"[object "+(this[or.toStringTag]||"Object")+"]"})},nr({_onAdd:yt(function(e){e>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(t,r){t>=e&&(this.__redo__[r]=++t)},this),this.__redo__.push(e)):Fr(this,"__redo__",yt("c",[e])))}),_onDelete:yt(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(t=this.__redo__.indexOf(e))&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,r){t>e&&(this.__redo__[r]=--t)},this)))}),_onClear:yt(function(){this.__redo__&&Me.call(this.__redo__),this.__nextIndex__=0})}))),Fr(Lr.prototype,or.iterator,yt(function(){return this}));var zr,Wr,Hr=Object.defineProperty;Wr=zr=function(e,t){if(!(this instanceof Wr))throw new TypeError("Constructor requires 'new'");qr.call(this,e),t=t?gt.call(t,"key+value")?"key+value":gt.call(t,"key")?"key":"value":"value",Hr(this,"__kind__",yt("",t))},Je&&Je(Wr,qr),delete Wr.prototype.constructor,Wr.prototype=Object.create(qr.prototype,{_resolve:yt(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),Hr(Wr.prototype,or.toStringTag,yt("c","Array Iterator"));var Kr,Vr,Qr=Object.defineProperty;Vr=Kr=function(e){if(!(this instanceof Vr))throw new TypeError("Constructor requires 'new'");e=String(e),qr.call(this,e),Qr(this,"__length__",yt("",e.length))},Je&&Je(Vr,qr),delete Vr.prototype.constructor,Vr.prototype=Object.create(qr.prototype,{_next:yt(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:yt(function(e){var t,r=this.__list__[e];return this.__nextIndex__===this.__length__?r:(t=r.charCodeAt(0))>=55296&&t<=56319?r+this.__list__[this.__nextIndex__++]:r})}),Qr(Vr.prototype,or.toStringTag,yt("c","String Iterator"));var $r,Zr,Gr=or.iterator,Jr=Array.isArray,Yr=Function.prototype.call,Xr=Array.prototype.some,en=function(e,t){var r,n,i,o,s,a,c,u,l,h=arguments[2];if(Jr(e)||cr(e)?r="array":hr(e)?r="string":e="function"==typeof dr(l=e)[Gr]?l[Gr]():cr(l)?new zr(l):hr(l)?new Kr(l):new zr(l),Ye(t),i=function(){o=!0},"array"!==r)if("string"!==r)for(n=e.next();!n.done;){if(Yr.call(t,h,n.value,i),o)return;n=e.next()}else for(a=e.length,s=0;s<a&&(c=e[s],s+1<a&&(u=c.charCodeAt(0))>=55296&&u<=56319&&(c+=e[++s]),Yr.call(t,h,c,i),!o);++s);else Xr.call(e,function(e){return Yr.call(t,h,e,i),o})},tn=Array.prototype.forEach,rn=Object.create,nn=function(e){var t=rn(null);return tn.call(arguments,function(e){t[e]=!0}),t}("key","value","key+value"),on=or.toStringTag,sn=Object.defineProperties,an=qr.prototype._unBind;Zr=$r=function(e,t){if(!(this instanceof Zr))return new Zr(e,t);qr.call(this,e.__mapKeysData__,e),t&&nn[t]||(t="key+value"),sn(this,{__kind__:yt("",t),__values__:yt("w",e.__mapValuesData__)})},Je&&Je(Zr,qr),Zr.prototype=Object.create(qr.prototype,{constructor:yt(Zr),_resolve:yt(function(e){return"value"===this.__kind__?this.__values__[e]:"key"===this.__kind__?this.__list__[e]:[this.__list__[e],this.__values__[e]]}),_unBind:yt(function(){this.__values__=null,an.call(this)}),toString:yt(function(){return"[object Map Iterator]"})}),Object.defineProperty(Zr.prototype,on,yt("c","Map Iterator"));var cn,un,ln="undefined"!=typeof Map&&"[object Map]"===Object.prototype.toString.call(new Map),hn=Function.prototype.call,fn=Object.defineProperties,pn=Object.getPrototypeOf;cn=un=function(){var e,t,r,n=arguments[0];if(!(this instanceof un))throw new TypeError("Constructor requires 'new'");return r=ln&&Je&&Map!==un?Je(new Map,pn(this)):this,null!=n&&dr(n),fn(r,{__mapKeysData__:yt("c",e=[]),__mapValuesData__:yt("c",t=[])}),n?(en(n,function(r){var n=je(r)[0];r=r[1],-1===He.call(e,n)&&(e.push(n),t.push(r))},r),r):r},ln&&(Je&&Je(un,Map),un.prototype=Object.create(Map.prototype,{constructor:yt(un)})),Et(fn(un.prototype,{clear:yt(function(){this.__mapKeysData__.length&&(Me.call(this.__mapKeysData__),Me.call(this.__mapValuesData__),this.emit("_clear"))}),delete:yt(function(e){var t=He.call(this.__mapKeysData__,e);return-1!==t&&(this.__mapKeysData__.splice(t,1),this.__mapValuesData__.splice(t,1),this.emit("_delete",t,e),!0)}),entries:yt(function(){return new $r(this,"key+value")}),forEach:yt(function(e){var t,r,n=arguments[1];for(Ye(e),r=(t=this.entries())._next();void 0!==r;)hn.call(e,n,this.__mapValuesData__[r],this.__mapKeysData__[r],this),r=t._next()}),get:yt(function(e){var t=He.call(this.__mapKeysData__,e);if(-1!==t)return this.__mapValuesData__[t]}),has:yt(function(e){return-1!==He.call(this.__mapKeysData__,e)}),keys:yt(function(){return new $r(this,"key")}),set:yt(function(e,t){var r,n=He.call(this.__mapKeysData__,e);return-1===n&&(n=this.__mapKeysData__.push(e)-1,r=!0),this.__mapValuesData__[n]=t,r&&this.emit("_add",n,e),this}),size:yt.gs(function(){return this.__mapKeysData__.length}),values:yt(function(){return new $r(this,"value")}),toString:yt(function(){return"[object Map]"})})),Object.defineProperty(un.prototype,or.iterator,yt(function(){return this.entries()})),Object.defineProperty(un.prototype,or.toStringTag,yt("c","Map"));var dn=function(){var e,t;if("function"!=typeof Map)return!1;try{e=new Map([["raz","one"],["dwa","two"],["trzy","three"]])}catch(r){return!1}return"[object Map]"===String(e)&&3===e.size&&"function"==typeof e.clear&&"function"==typeof e.delete&&"function"==typeof e.entries&&"function"==typeof e.forEach&&"function"==typeof e.get&&"function"==typeof e.has&&"function"==typeof e.keys&&"function"==typeof e.set&&"function"==typeof e.values&&!1===(t=e.entries().next()).done&&!!t.value&&"raz"===t.value[0]&&"one"===t.value[1]}()?Map:cn,gn={};(function(e){"use strict";var t=Ce.Readable,r={objectMode:!0},n={clean:!0};function i(e){if(!(this instanceof i))return new i(e);this.options=e||{},this.options=O(n,e),this._inflights=new dn}i.prototype.put=function(e,t){return this._inflights.set(e.messageId,e),t&&t(),this},i.prototype.createStream=function(){var n=new t(r),i=!1,o=[],s=0;return this._inflights.forEach(function(e,t){o.push(e)}),n._read=function(){!i&&s<o.length?this.push(o[s++]):this.push(null)},n.destroy=function(){if(!i){var t=this;i=!0,e.nextTick(function(){t.emit("close")})}},n},i.prototype.del=function(e,t){return(e=this._inflights.get(e.messageId))?(this._inflights.delete(e.messageId),t(null,e)):t&&t(new Error("missing packet")),this},i.prototype.get=function(e,t){return(e=this._inflights.get(e.messageId))?t(null,e):t&&t(new Error("missing packet")),this},i.prototype.close=function(e){this.options.clean&&(this._inflights=null),e&&e()},gn=i}).call(this,P);var yn=s({}),_n={};_n="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};var bn={};(function(e,t){function r(e,t){var r={seen:[],stylize:i};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),u(t)?r.showHidden=t:t&&bn._extend(r,t),p(r.showHidden)&&(r.showHidden=!1),p(r.depth)&&(r.depth=2),p(r.colors)&&(r.colors=!1),p(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=n),o(r,e,r.depth)}function n(e,t){var n=r.styles[t];return n?"\x1b["+r.colors[n][0]+"m"+e+"\x1b["+r.colors[n][1]+"m":e}function i(e,t){return e}function o(e,t,r){if(e.customInspect&&t&&b(t.inspect)&&t.inspect!==bn.inspect&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return f(n)||(n=o(e,n,r)),n}var i=function(e,t){if(p(t))return e.stylize("undefined","undefined");if(f(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return h(t)?e.stylize(""+t,"number"):u(t)?e.stylize(""+t,"boolean"):l(t)?e.stylize("null","null"):void 0}(e,t);if(i)return i;var g,m=Object.keys(t),w=(g={},m.forEach(function(e,t){g[e]=!0}),g);if(e.showHidden&&(m=Object.getOwnPropertyNames(t)),_(t)&&(m.indexOf("message")>=0||m.indexOf("description")>=0))return s(t);if(0===m.length){if(b(t)){var S=t.name?": "+t.name:"";return e.stylize("[Function"+S+"]","special")}if(d(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(y(t))return e.stylize(Date.prototype.toString.call(t),"date");if(_(t))return s(t)}var k,E="",I=!1,C=["{","}"];return c(t)&&(I=!0,C=["[","]"]),b(t)&&(E=" [Function"+(t.name?": "+t.name:"")+"]"),d(t)&&(E=" "+RegExp.prototype.toString.call(t)),y(t)&&(E=" "+Date.prototype.toUTCString.call(t)),_(t)&&(E=" "+s(t)),0!==m.length||I&&0!=t.length?r<0?d(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),k=I?function(e,t,r,n,i){for(var o=[],s=0,c=t.length;s<c;++s)v(t,String(s))?o.push(a(e,t,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(a(e,t,r,n,i,!0))}),o}(e,t,r,w,m):m.map(function(n){return a(e,t,r,w,n,I)}),e.seen.pop(),function(e,t,r){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}(k,E,C)):C[0]+E+C[1]}function s(e){return"["+Error.prototype.toString.call(e)+"]"}function a(e,t,r,n,i,s){var a,c,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?c=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(c=e.stylize("[Setter]","special")),v(n,i)||(a="["+i+"]"),c||(e.seen.indexOf(u.value)<0?(c=l(r)?o(e,u.value,null):o(e,u.value,r-1)).indexOf("\n")>-1&&(c=s?c.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+c.split("\n").map(function(e){return"   "+e}).join("\n")):c=e.stylize("[Circular]","special")),p(a)){if(s&&i.match(/^\d+$/))return c;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+c}function c(e){return Array.isArray(e)}function u(e){return"boolean"==typeof e}function l(e){return null===e}function h(e){return"number"==typeof e}function f(e){return"string"==typeof e}function p(e){return void 0===e}function d(e){return g(e)&&"[object RegExp]"===m(e)}function g(e){return"object"==typeof e&&null!==e}function y(e){return g(e)&&"[object Date]"===m(e)}function _(e){return g(e)&&("[object Error]"===m(e)||e instanceof Error)}function b(e){return"function"==typeof e}function m(e){return Object.prototype.toString.call(e)}bn.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}bn.inherits=_n,bn._extend=function(e,t){if(!t||!g(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,P,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var mn={},vn=re.Buffer;function wn(e){if(!(this instanceof wn))return new wn(e);if(this._bufs=[],this.length=0,"function"==typeof e){this._callback=e;var t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",function(e){e.on("error",t)}),this.on("unpipe",function(e){e.removeListener("error",t)})}else this.append(e);yn.call(this)}bn.inherits(wn,yn),wn.prototype._offset=function(e){var t,r=0,n=0;if(0===e)return[0,0];for(;n<this._bufs.length;n++){if(e<(t=r+this._bufs[n].length)||n==this._bufs.length-1)return[n,e-r];r=t}},wn.prototype.append=function(e){var t=0;if(vn.isBuffer(e))this._appendBuffer(e);else if(Array.isArray(e))for(;t<e.length;t++)this.append(e[t]);else if(e instanceof wn)for(;t<e._bufs.length;t++)this.append(e._bufs[t]);else null!=e&&("number"==typeof e&&(e=e.toString()),this._appendBuffer(vn.from(e)));return this},wn.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},wn.prototype._write=function(e,t,r){this._appendBuffer(e),"function"==typeof r&&r()},wn.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},wn.prototype.end=function(e){yn.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},wn.prototype.get=function(e){return this.slice(e,e+1)[0]},wn.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},wn.prototype.copy=function(e,t,r,n){if(("number"!=typeof r||r<0)&&(r=0),("number"!=typeof n||n>this.length)&&(n=this.length),r>=this.length)return e||vn.alloc(0);if(n<=0)return e||vn.alloc(0);var i,o,s=!!e,a=this._offset(r),c=n-r,u=c,l=s&&t||0,h=a[1];if(0===r&&n==this.length){if(!s)return 1===this._bufs.length?this._bufs[0]:vn.concat(this._bufs,this.length);for(o=0;o<this._bufs.length;o++)this._bufs[o].copy(e,l),l+=this._bufs[o].length;return e}if(u<=this._bufs[a[0]].length-h)return s?this._bufs[a[0]].copy(e,t,h,h+u):this._bufs[a[0]].slice(h,h+u);for(s||(e=vn.allocUnsafe(c)),o=a[0];o<this._bufs.length;o++){if(!(u>(i=this._bufs[o].length-h))){this._bufs[o].copy(e,l,h,h+u);break}this._bufs[o].copy(e,l,h),l+=i,u-=i,h&&(h=0)}return e},wn.prototype.shallowSlice=function(e,t){e=e||0,t=t||this.length,e<0&&(e+=this.length),t<0&&(t+=this.length);var r=this._offset(e),n=this._offset(t),i=this._bufs.slice(r[0],n[0]+1);return 0==n[1]?i.pop():i[i.length-1]=i[i.length-1].slice(0,n[1]),0!=r[1]&&(i[0]=i[0].slice(r[1])),new wn(i)},wn.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)},wn.prototype.consume=function(e){for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},wn.prototype.duplicate=function(){for(var e=0,t=new wn;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},wn.prototype.destroy=function(){this._bufs.length=0,this.length=0,this.push(null)},function(){var e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};for(var t in e)!function(t){wn.prototype[t]=function(r){return this.slice(r,r+e[t])[t](0)}}(t)}(),mn=wn;var Sn=function(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null},kn={},En=re.Buffer,In=kn;for(var Cn in In.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},In.codes={},In.types){var On=In.types[Cn];In.codes[On]=Cn}for(var An in In.CMD_SHIFT=4,In.CMD_MASK=240,In.DUP_MASK=8,In.QOS_MASK=3,In.QOS_SHIFT=1,In.RETAIN_MASK=1,In.LENGTH_MASK=127,In.LENGTH_FIN_MASK=128,In.SESSIONPRESENT_MASK=1,In.SESSIONPRESENT_HEADER=En.from([In.SESSIONPRESENT_MASK]),In.CONNACK_HEADER=En.from([In.codes.connack<<In.CMD_SHIFT]),In.USERNAME_MASK=128,In.PASSWORD_MASK=64,In.WILL_RETAIN_MASK=32,In.WILL_QOS_MASK=24,In.WILL_QOS_SHIFT=3,In.WILL_FLAG_MASK=4,In.CLEAN_SESSION_MASK=2,In.CONNECT_HEADER=En.from([In.codes.connect<<In.CMD_SHIFT]),In.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},In.propertiesCodes={},In.properties){var Pn=In.properties[An];In.propertiesCodes[Pn]=An}function Tn(e){return[0,1,2].map(function(t){return[0,1].map(function(r){return[0,1].map(function(n){var i=En.alloc(1);return i.writeUInt8(In.codes[e]<<In.CMD_SHIFT|(r?In.DUP_MASK:0)|t<<In.QOS_SHIFT|n,0,!0),i})})})}In.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},In.PUBLISH_HEADER=Tn("publish"),In.SUBSCRIBE_HEADER=Tn("subscribe"),In.SUBSCRIBE_OPTIONS_QOS_MASK=3,In.SUBSCRIBE_OPTIONS_NL_MASK=1,In.SUBSCRIBE_OPTIONS_NL_SHIFT=2,In.SUBSCRIBE_OPTIONS_RAP_MASK=1,In.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,In.SUBSCRIBE_OPTIONS_RH_MASK=3,In.SUBSCRIBE_OPTIONS_RH_SHIFT=4,In.SUBSCRIBE_OPTIONS_RH=[0,16,32],In.SUBSCRIBE_OPTIONS_NL=4,In.SUBSCRIBE_OPTIONS_RAP=8,In.SUBSCRIBE_OPTIONS_QOS=[0,1,2],In.UNSUBSCRIBE_HEADER=Tn("unsubscribe"),In.ACKS={unsuback:Tn("unsuback"),puback:Tn("puback"),pubcomp:Tn("pubcomp"),pubrel:Tn("pubrel"),pubrec:Tn("pubrec")},In.SUBACK_HEADER=En.from([In.codes.suback<<In.CMD_SHIFT]),In.VERSION3=En.from([3]),In.VERSION4=En.from([4]),In.VERSION5=En.from([5]),In.QOS=[0,1,2].map(function(e){return En.from([e])}),In.EMPTY={pingreq:En.from([In.codes.pingreq<<4,0]),pingresp:En.from([In.codes.pingresp<<4,0]),disconnect:En.from([In.codes.disconnect<<4,0])};var xn={};(function(e){xn.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},xn.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+xn.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(n=r))}),e.splice(n,0,t)},xn.save=function(e){try{e?xn.storage.setItem("debug",e):xn.storage.removeItem("debug")}catch(t){}},xn.load=function(){let t;try{t=xn.storage.getItem("debug")}catch(r){}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},xn.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},xn.storage=function(){try{return localStorage}catch(e){}}(),xn.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],xn=function(e){function r(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){let t;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(t||i);r.diff=o,r.prev=t,r.curr=i,t=i,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,i)=>{if("%%"===t)return t;a++;const o=n.formatters[i];if("function"==typeof o){const n=e[a];t=o.call(r,n),e.splice(a,1),a--}return t}),n.formatArgs.call(r,e),(r.log||n.log).apply(r,e)}return s.namespace=e,s.enabled=n.enabled(e),s.useColors=n.useColors(),s.color=r(e),s.destroy=i,s.extend=o,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function i(){const e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function o(e,t){const r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){const e=[...n.names.map(s),...n.skips.map(s).map(e=>"-"+e)].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.names=[],n.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){const e=n.instances[t];e.enabled=n.enabled(e.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=t({}),Object.keys(e).forEach(t=>{n[t]=e[t]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=r,n.enable(n.load()),n}(xn);const{formatters:r}=xn;r.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,P);var jn,Mn=l.EventEmitter,Bn=xn("mqtt-packet:parser");function Rn(e){if(!(this instanceof Rn))return new Rn(e);this.settings=e||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState()}ue(Rn,Mn),Rn.prototype._resetState=function(){Bn("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new Sn,this.error=null,this._list=mn(),this._stateCounter=0},Rn.prototype.parse=function(e){for(this.error&&this._resetState(),this._list.append(e),Bn("parse: current state: %s",this._states[this._stateCounter]);(-1!==this.packet.length||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,Bn("parse: state complete. _stateCounter is now: %d",this._stateCounter),Bn("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return Bn("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length},Rn.prototype._parseHeader=function(){var e=this._list.readUInt8(0);return this.packet.cmd=kn.types[e>>kn.CMD_SHIFT],this.packet.retain=0!=(e&kn.RETAIN_MASK),this.packet.qos=e>>kn.QOS_SHIFT&kn.QOS_MASK,this.packet.dup=0!=(e&kn.DUP_MASK),Bn("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0},Rn.prototype._parseLength=function(){var e=this._parseVarByteNum(!0);return e&&(this.packet.length=e.value,this._list.consume(e.bytes)),Bn("_parseLength %d",e.value),!!e},Rn.prototype._parsePayload=function(){Bn("_parsePayload: payload %O",this._list);var e=!1;if(0===this.packet.length||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}e=!0}return Bn("_parsePayload complete result: %s",e),e},Rn.prototype._parseConnect=function(){var e,t,r,n,i,o;Bn("_parseConnect");var s={},a=this.packet;if(null===(e=this._parseString()))return this._emitError(new Error("Cannot parse protocolId"));if("MQTT"!==e&&"MQIsdp"!==e)return this._emitError(new Error("Invalid protocolId"));if(a.protocolId=e,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(a.protocolVersion=this._list.readUInt8(this._pos),3!==a.protocolVersion&&4!==a.protocolVersion&&5!==a.protocolVersion)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(s.username=this._list.readUInt8(this._pos)&kn.USERNAME_MASK,s.password=this._list.readUInt8(this._pos)&kn.PASSWORD_MASK,s.will=this._list.readUInt8(this._pos)&kn.WILL_FLAG_MASK,s.will&&(a.will={},a.will.retain=0!=(this._list.readUInt8(this._pos)&kn.WILL_RETAIN_MASK),a.will.qos=(this._list.readUInt8(this._pos)&kn.WILL_QOS_MASK)>>kn.WILL_QOS_SHIFT),a.clean=0!=(this._list.readUInt8(this._pos)&kn.CLEAN_SESSION_MASK),this._pos++,a.keepalive=this._parseNum(),-1===a.keepalive)return this._emitError(new Error("Packet too short"));if(5===a.protocolVersion){var c=this._parseProperties();Object.getOwnPropertyNames(c).length&&(a.properties=c)}if(null===(t=this._parseString()))return this._emitError(new Error("Packet too short"));if(a.clientId=t,Bn("_parseConnect: packet.clientId: %s",a.clientId),s.will){if(5===a.protocolVersion){var u=this._parseProperties();Object.getOwnPropertyNames(u).length&&(a.will.properties=u)}if(null===(r=this._parseString()))return this._emitError(new Error("Cannot parse will topic"));if(a.will.topic=r,Bn("_parseConnect: packet.will.topic: %s",a.will.topic),null===(n=this._parseBuffer()))return this._emitError(new Error("Cannot parse will payload"));a.will.payload=n,Bn("_parseConnect: packet.will.paylaod: %s",a.will.payload)}if(s.username){if(null===(o=this._parseString()))return this._emitError(new Error("Cannot parse username"));a.username=o,Bn("_parseConnect: packet.username: %s",a.username)}if(s.password){if(null===(i=this._parseBuffer()))return this._emitError(new Error("Cannot parse password"));a.password=i}return this.settings=a,Bn("_parseConnect: complete"),a},Rn.prototype._parseConnack=function(){Bn("_parseConnack");var e=this.packet;if(this._list.length<2)return null;if(e.sessionPresent=!!(this._list.readUInt8(this._pos++)&kn.SESSIONPRESENT_MASK),5===this.settings.protocolVersion?e.reasonCode=this._list.readUInt8(this._pos++):e.returnCode=this._list.readUInt8(this._pos++),-1===e.returnCode||-1===e.reasonCode)return this._emitError(new Error("Cannot parse return code"));if(5===this.settings.protocolVersion){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}Bn("_parseConnack: complete")},Rn.prototype._parsePublish=function(){Bn("_parsePublish");var e=this.packet;if(e.topic=this._parseString(),null===e.topic)return this._emitError(new Error("Cannot parse topic"));if(!(e.qos>0)||this._parseMessageId()){if(5===this.settings.protocolVersion){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}e.payload=this._list.slice(this._pos,e.length),Bn("_parsePublish: payload from buffer list: %o",e.payload)}},Rn.prototype._parseSubscribe=function(){Bn("_parseSubscribe");var e,t,r,n,i,o,s,a=this.packet;if(1!==a.qos)return this._emitError(new Error("Wrong subscribe header"));if(a.subscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){var c=this._parseProperties();Object.getOwnPropertyNames(c).length&&(a.properties=c)}for(;this._pos<a.length;){if(null===(e=this._parseString()))return this._emitError(new Error("Cannot parse topic"));if(this._pos>=a.length)return this._emitError(new Error("Malformed Subscribe Payload"));r=(t=this._parseByte())&kn.SUBSCRIBE_OPTIONS_QOS_MASK,o=0!=(t>>kn.SUBSCRIBE_OPTIONS_NL_SHIFT&kn.SUBSCRIBE_OPTIONS_NL_MASK),i=0!=(t>>kn.SUBSCRIBE_OPTIONS_RAP_SHIFT&kn.SUBSCRIBE_OPTIONS_RAP_MASK),n=t>>kn.SUBSCRIBE_OPTIONS_RH_SHIFT&kn.SUBSCRIBE_OPTIONS_RH_MASK,s={topic:e,qos:r},5===this.settings.protocolVersion&&(s.nl=o,s.rap=i,s.rh=n),Bn("_parseSubscribe: push subscription `%s` to subscription",s),a.subscriptions.push(s)}}},Rn.prototype._parseSuback=function(){Bn("_parseSuback");var e=this.packet;if(this.packet.granted=[],this._parseMessageId()){if(5===this.settings.protocolVersion){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}for(;this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}},Rn.prototype._parseUnsubscribe=function(){Bn("_parseUnsubscribe");var e=this.packet;if(e.unsubscriptions=[],this._parseMessageId()){if(5===this.settings.protocolVersion){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}for(;this._pos<e.length;){var r;if(null===(r=this._parseString()))return this._emitError(new Error("Cannot parse topic"));Bn("_parseUnsubscribe: push topic `%s` to unsubscriptions",r),e.unsubscriptions.push(r)}}},Rn.prototype._parseUnsuback=function(){Bn("_parseUnsuback");var e=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if(5===this.settings.protocolVersion){var t=this._parseProperties();for(Object.getOwnPropertyNames(t).length&&(e.properties=t),e.granted=[];this._pos<this.packet.length;)this.packet.granted.push(this._list.readUInt8(this._pos++))}},Rn.prototype._parseConfirmation=function(){Bn("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);var e=this.packet;if(this._parseMessageId(),5===this.settings.protocolVersion&&(e.length>2&&(e.reasonCode=this._parseByte(),Bn("_parseConfirmation: packet.reasonCode `%d`",e.reasonCode)),e.length>3)){var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}return!0},Rn.prototype._parseDisconnect=function(){var e=this.packet;if(Bn("_parseDisconnect"),5===this.settings.protocolVersion){e.reasonCode=this._parseByte();var t=this._parseProperties();Object.getOwnPropertyNames(t).length&&(e.properties=t)}return Bn("_parseDisconnect result: true"),!0},Rn.prototype._parseAuth=function(){Bn("_parseAuth");var e=this.packet;if(5!==this.settings.protocolVersion)return this._emitError(new Error("Not supported auth packet for this version MQTT"));e.reasonCode=this._parseByte();var t=this._parseProperties();return Object.getOwnPropertyNames(t).length&&(e.properties=t),Bn("_parseAuth: result: true"),!0},Rn.prototype._parseMessageId=function(){var e=this.packet;return e.messageId=this._parseNum(),null===e.messageId?(this._emitError(new Error("Cannot parse messageId")),!1):(Bn("_parseMessageId: packet.messageId %d",e.messageId),!0)},Rn.prototype._parseString=function(e){var t,r=this._parseNum(),n=r+this._pos;return-1===r||n>this._list.length||n>this.packet.length?null:(t=this._list.toString("utf8",this._pos,n),this._pos+=r,Bn("_parseString: result: %s",t),t)},Rn.prototype._parseStringPair=function(){return Bn("_parseStringPair"),{name:this._parseString(),value:this._parseString()}},Rn.prototype._parseBuffer=function(){var e,t=this._parseNum(),r=t+this._pos;return-1===t||r>this._list.length||r>this.packet.length?null:(e=this._list.slice(this._pos,r),this._pos+=t,Bn("_parseBuffer: result: %o",e),e)},Rn.prototype._parseNum=function(){if(this._list.length-this._pos<2)return-1;var e=this._list.readUInt16BE(this._pos);return this._pos+=2,Bn("_parseNum: result: %s",e),e},Rn.prototype._parse4ByteNum=function(){if(this._list.length-this._pos<4)return-1;var e=this._list.readUInt32BE(this._pos);return this._pos+=4,Bn("_parse4ByteNum: result: %s",e),e},Rn.prototype._parseVarByteNum=function(e){Bn("_parseVarByteNum");for(var t,r=0,n=1,i=0,o=!0,s=this._pos?this._pos:0;r<5&&(i+=n*((t=this._list.readUInt8(s+r++))&kn.LENGTH_MASK),n*=128,0!=(t&kn.LENGTH_FIN_MASK));)if(this._list.length<=r){o=!1;break}return s&&(this._pos+=r),Bn("_parseVarByteNum: result: %o",o=!!o&&(e?{bytes:r,value:i}:i)),o},Rn.prototype._parseByte=function(){var e=this._list.readUInt8(this._pos);return this._pos++,Bn("_parseByte: result: %o",e),e},Rn.prototype._parseByType=function(e){switch(Bn("_parseByType: type: %s",e),e){case"byte":return 0!==this._parseByte();case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}},Rn.prototype._parseProperties=function(){Bn("_parseProperties");for(var e=this._parseVarByteNum(),t=this._pos+e,r={};this._pos<t;){var n=this._parseByte(),i=kn.propertiesCodes[n];if(!i)return this._emitError(new Error("Unknown property")),!1;if("userProperties"!==i)r[i]?Array.isArray(r[i])?r[i].push(this._parseByType(kn.propertiesTypes[i])):(r[i]=[r[i]],r[i].push(this._parseByType(kn.propertiesTypes[i]))):r[i]=this._parseByType(kn.propertiesTypes[i]);else{r[i]||(r[i]={});var o=this._parseByType(kn.propertiesTypes[i]);if(r[i][o.name])if(Array.isArray(r[i][o.name]))r[i][o.name].push(o.value);else{var s=r[i][o.name];r[i][o.name]=[s],r[i][o.name].push(o.value)}else r[i][o.name]=o.value}}return r},Rn.prototype._newPacket=function(){return Bn("_newPacket"),this.packet&&(this._list.consume(this.packet.length),Bn("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),Bn("_newPacket: new packet"),this.packet=new Sn,this._pos=0,!0},Rn.prototype._emitError=function(e){Bn("_emitError"),this.error=e,this.emit("error",e)},jn=Rn;var Un=re.Buffer,Nn={};function Ln(e){var t=Un.allocUnsafe(2);return t.writeUInt8(e>>8,0),t.writeUInt8(255&e,1),t}var qn={cache:Nn,generateCache:function(){for(var e=0;e<65536;e++)Nn[e]=Ln(e)},generateNumber:Ln,genBufVariableByteInt:function(e){var t=0,r=0,n=e>=0&&e<128?1:e>=128&&e<16384?2:e>=16384&&e<2097152?3:e>=2097152&&e<268435456?4:0,i=Un.allocUnsafe(n);do{t=e%128|0,(e=e/128|0)>0&&(t|=128),i.writeUInt8(t,r++)}while(e>0);return{data:i,length:n}},generate4ByteBuffer:function(e){var t=Un.allocUnsafe(4);return t.writeUInt32BE(e,0),t}},Fn=re.Buffer,Dn=Fn.allocUnsafe(0),zn=Fn.from([0]),Wn=z.nextTick,Hn=xn("mqtt-packet:writeToStream"),Kn=qn.cache,Vn=qn.generateNumber,Qn=qn.generateCache,$n=qn.genBufVariableByteInt,Zn=qn.generate4ByteBuffer,Gn=ii,Jn=!0;function Yn(e,t,r){switch(Hn("generate called"),t.cork&&(t.cork(),Wn(Xn,t)),Jn&&(Jn=!1,Qn()),Hn("generate: packet.cmd: %s",e.cmd),e.cmd){case"connect":return function(e,t,r){var n=e||{},i=n.protocolId||"MQTT",o=n.protocolVersion||4,s=n.will,a=n.clean,c=n.keepalive||0,u=n.clientId||"",l=n.username,h=n.password,f=n.properties;void 0===a&&(a=!0);var p=0;if(!i||"string"!=typeof i&&!Fn.isBuffer(i))return t.emit("error",new Error("Invalid protocolId")),!1;if(p+=i.length+2,3!==o&&4!==o&&5!==o)return t.emit("error",new Error("Invalid protocol version")),!1;if(p+=1,"string"!=typeof u&&!Fn.isBuffer(u)||!u&&4!==o||!u&&!a){if(o<4)return t.emit("error",new Error("clientId must be supplied before 3.1.1")),!1;if(1*a==0)return t.emit("error",new Error("clientId must be given if cleanSession set to 0")),!1}else p+=u.length+2;if("number"!=typeof c||c<0||c>65535||c%1!=0)return t.emit("error",new Error("Invalid keepalive")),!1;if(p+=2,p+=1,5===o){var d=ai(t,f);if(!d)return!1;p+=d.length}if(s){if("object"!=typeof s)return t.emit("error",new Error("Invalid will")),!1;if(!s.topic||"string"!=typeof s.topic)return t.emit("error",new Error("Invalid will topic")),!1;if(p+=Fn.byteLength(s.topic)+2,p+=2,s.payload){if(!(s.payload.length>=0))return t.emit("error",new Error("Invalid will payload")),!1;"string"==typeof s.payload?p+=Fn.byteLength(s.payload):p+=s.payload.length}var g={};if(5===o){if(!(g=ai(t,s.properties)))return!1;p+=g.length}}var y=!1;if(null!=l){if(!fi(l))return t.emit("error",new Error("Invalid username")),!1;y=!0,p+=Fn.byteLength(l)+2}if(null!=h){if(!y)return t.emit("error",new Error("Username is required to use password")),!1;if(!fi(h))return t.emit("error",new Error("Invalid password")),!1;p+=hi(h)+2}t.write(kn.CONNECT_HEADER),ti(t,p),si(t,i),t.write(4===o?kn.VERSION4:5===o?kn.VERSION5:kn.VERSION3);var _=0;return _|=null!=l?kn.USERNAME_MASK:0,_|=null!=h?kn.PASSWORD_MASK:0,_|=s&&s.retain?kn.WILL_RETAIN_MASK:0,_|=s&&s.qos?s.qos<<kn.WILL_QOS_SHIFT:0,_|=s?kn.WILL_FLAG_MASK:0,_|=a?kn.CLEAN_SESSION_MASK:0,t.write(Fn.from([_])),Gn(t,c),5===o&&d.write(),si(t,u),s&&(5===o&&g.write(),ri(t,s.topic),si(t,s.payload)),null!=l&&si(t,l),null!=h&&si(t,h),!0}(e,t);case"connack":return function(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=5===n?i.reasonCode:i.returnCode,s=i.properties,a=2;if("number"!=typeof o)return t.emit("error",new Error("Invalid return code")),!1;var c=null;if(5===n){if(!(c=ai(t,s)))return!1;a+=c.length}return t.write(kn.CONNACK_HEADER),ti(t,a),t.write(i.sessionPresent?kn.SESSIONPRESENT_HEADER:zn),t.write(Fn.from([o])),null!=c&&c.write(),!0}(e,t,r);case"publish":return function(e,t,r){Hn("publish: packet: %o",e);var n=r?r.protocolVersion:4,i=e||{},o=i.qos||0,s=i.retain?kn.RETAIN_MASK:0,a=i.topic,c=i.payload||Dn,u=i.messageId,l=i.properties,h=0;if("string"==typeof a)h+=Fn.byteLength(a)+2;else{if(!Fn.isBuffer(a))return t.emit("error",new Error("Invalid topic")),!1;h+=a.length+2}if(Fn.isBuffer(c)?h+=c.length:h+=Fn.byteLength(c),o&&"number"!=typeof u)return t.emit("error",new Error("Invalid messageId")),!1;o&&(h+=2);var f=null;if(5===n){if(!(f=ai(t,l)))return!1;h+=f.length}return t.write(kn.PUBLISH_HEADER[o][i.dup?1:0][s?1:0]),ti(t,h),Gn(t,hi(a)),t.write(a),o>0&&Gn(t,u),null!=f&&f.write(),Hn("publish: payload: %o",c),t.write(c)}(e,t,r);case"puback":case"pubrec":case"pubrel":case"pubcomp":return function(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.cmd||"puback",s=i.messageId,a=i.dup&&"pubrel"===o?kn.DUP_MASK:0,c=0,u=i.reasonCode,l=i.properties,h=5===n?3:2;if("pubrel"===o&&(c=1),"number"!=typeof s)return t.emit("error",new Error("Invalid messageId")),!1;var f=null;if(5===n&&"object"==typeof l){if(!(f=ci(t,l,r,h)))return!1;h+=f.length}return t.write(kn.ACKS[o][c][a][0]),ti(t,h),Gn(t,s),5===n&&t.write(Fn.from([u])),null!==f&&f.write(),!0}(e,t,r);case"subscribe":return function(e,t,r){Hn("subscribe: packet: ");var n=r?r.protocolVersion:4,i=e||{},o=i.dup?kn.DUP_MASK:0,s=i.messageId,a=i.subscriptions,c=i.properties,u=0;if("number"!=typeof s)return t.emit("error",new Error("Invalid messageId")),!1;u+=2;var l=null;if(5===n){if(!(l=ai(t,c)))return!1;u+=l.length}if("object"!=typeof a||!a.length)return t.emit("error",new Error("Invalid subscriptions")),!1;for(var h=0;h<a.length;h+=1){var f=a[h].topic,p=a[h].qos;if("string"!=typeof f)return t.emit("error",new Error("Invalid subscriptions - invalid topic")),!1;if("number"!=typeof p)return t.emit("error",new Error("Invalid subscriptions - invalid qos")),!1;if(5===n){if("boolean"!=typeof(a[h].nl||!1))return t.emit("error",new Error("Invalid subscriptions - invalid No Local")),!1;if("boolean"!=typeof(a[h].rap||!1))return t.emit("error",new Error("Invalid subscriptions - invalid Retain as Published")),!1;var d=a[h].rh||0;if("number"!=typeof d||d>2)return t.emit("error",new Error("Invalid subscriptions - invalid Retain Handling")),!1}u+=Fn.byteLength(f)+2+1}Hn("subscribe: writing to stream: %o",kn.SUBSCRIBE_HEADER),t.write(kn.SUBSCRIBE_HEADER[1][o?1:0][0]),ti(t,u),Gn(t,s),null!==l&&l.write();for(var g=!0,y=0;y<a.length;y++){var _,b=a[y],m=b.topic,v=b.qos,w=+b.nl,S=+b.rap,k=b.rh;ri(t,m),_=kn.SUBSCRIBE_OPTIONS_QOS[v],5===n&&(_|=w?kn.SUBSCRIBE_OPTIONS_NL:0,_|=S?kn.SUBSCRIBE_OPTIONS_RAP:0,_|=k?kn.SUBSCRIBE_OPTIONS_RH[k]:0),g=t.write(Fn.from([_]))}return g}(e,t,r);case"suback":return function(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.messageId,s=i.granted,a=i.properties,c=0;if("number"!=typeof o)return t.emit("error",new Error("Invalid messageId")),!1;if(c+=2,"object"!=typeof s||!s.length)return t.emit("error",new Error("Invalid qos vector")),!1;for(var u=0;u<s.length;u+=1){if("number"!=typeof s[u])return t.emit("error",new Error("Invalid qos vector")),!1;c+=1}var l=null;if(5===n){if(!(l=ci(t,a,r,c)))return!1;c+=l.length}return t.write(kn.SUBACK_HEADER),ti(t,c),Gn(t,o),null!==l&&l.write(),t.write(Fn.from(s))}(e,t,r);case"unsubscribe":return function(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.messageId,s=i.dup?kn.DUP_MASK:0,a=i.unsubscriptions,c=i.properties,u=0;if("number"!=typeof o)return t.emit("error",new Error("Invalid messageId")),!1;if(u+=2,"object"!=typeof a||!a.length)return t.emit("error",new Error("Invalid unsubscriptions")),!1;for(var l=0;l<a.length;l+=1){if("string"!=typeof a[l])return t.emit("error",new Error("Invalid unsubscriptions")),!1;u+=Fn.byteLength(a[l])+2}var h=null;if(5===n){if(!(h=ai(t,c)))return!1;u+=h.length}t.write(kn.UNSUBSCRIBE_HEADER[1][s?1:0][0]),ti(t,u),Gn(t,o),null!==h&&h.write();for(var f=!0,p=0;p<a.length;p++)f=ri(t,a[p]);return f}(e,t,r);case"unsuback":return function(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.messageId,s=i.dup?kn.DUP_MASK:0,a=i.granted,c=i.properties,u=i.cmd,l=2;if("number"!=typeof o)return t.emit("error",new Error("Invalid messageId")),!1;if(5===n){if("object"!=typeof a||!a.length)return t.emit("error",new Error("Invalid qos vector")),!1;for(var h=0;h<a.length;h+=1){if("number"!=typeof a[h])return t.emit("error",new Error("Invalid qos vector")),!1;l+=1}}var f=null;if(5===n){if(!(f=ci(t,c,r,l)))return!1;l+=f.length}return t.write(kn.ACKS[u][0][s][0]),ti(t,l),Gn(t,o),null!==f&&f.write(),5===n&&t.write(Fn.from(a)),!0}(e,t,r);case"pingreq":case"pingresp":return function(e,t,r){return t.write(kn.EMPTY[e.cmd])}(e,t);case"disconnect":return function(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.reasonCode,s=i.properties,a=5===n?1:0,c=null;if(5===n){if(!(c=ci(t,s,r,a)))return!1;a+=c.length}return t.write(Fn.from([kn.codes.disconnect<<4])),ti(t,a),5===n&&t.write(Fn.from([o])),null!==c&&c.write(),!0}(e,t,r);case"auth":return function(e,t,r){var n=r?r.protocolVersion:4,i=e||{},o=i.reasonCode,s=i.properties,a=5===n?1:0;5!==n&&t.emit("error",new Error("Invalid mqtt version for auth packet"));var c=ci(t,s,r,a);return!!c&&(a+=c.length,t.write(Fn.from([kn.codes.auth<<4])),ti(t,a),t.write(Fn.from([o])),null!==c&&c.write(),!0)}(e,t,r);default:return t.emit("error",new Error("Unknown command")),!1}}function Xn(e){e.uncork()}Object.defineProperty(Yn,"cacheNumbers",{get:function(){return Gn===ii},set:function(e){e?(Kn&&0!==Object.keys(Kn).length||(Jn=!0),Gn=ii):(Jn=!1,Gn=oi)}});var ei={};function ti(e,t){var r=ei[t];r||(r=$n(t).data,t<16384&&(ei[t]=r)),Hn("writeVarByteInt: writing to stream: %o",r),e.write(r)}function ri(e,t){var r=Fn.byteLength(t);return Gn(e,r),Hn("writeString: %s",t),e.write(t,"utf8")}function ni(e,t,r){ri(e,t),ri(e,r)}function ii(e,t){return Hn("writeNumberCached: number: %d",t),Hn("writeNumberCached: %o",Kn[t]),e.write(Kn[t])}function oi(e,t){var r=Vn(t);return Hn("writeNumberGenerated: %o",r),e.write(r)}function si(e,t){"string"==typeof t?ri(e,t):t?(Gn(e,t.length),e.write(t)):Gn(e,0)}function ai(e,t){if("object"!=typeof t||null!=t.length)return{length:1,write:function(){li(e,{},0)}};var r=0;function n(t,r){var n=0;switch(kn.propertiesTypes[t]){case"byte":if("boolean"!=typeof r)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=2;break;case"int8":if("number"!=typeof r||r<0||r>255)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=2;break;case"binary":if(r&&null===r)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=1+Fn.byteLength(r)+2;break;case"int16":if("number"!=typeof r||r<0||r>65535)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=3;break;case"int32":if("number"!=typeof r||r<0||r>4294967295)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=5;break;case"var":if("number"!=typeof r||r<0||r>4294967295)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=1+$n(r).length;break;case"string":if("string"!=typeof r)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=3+Fn.byteLength(r.toString());break;case"pair":if("object"!=typeof r)return e.emit("error",new Error("Invalid "+t+": "+r)),!1;n+=Object.getOwnPropertyNames(r).reduce(function(e,t){var n=r[t];return Array.isArray(n)?e+=n.reduce(function(e,r){return e+(3+Fn.byteLength(t.toString())+2+Fn.byteLength(r.toString()))},0):e+=3+Fn.byteLength(t.toString())+2+Fn.byteLength(r[t].toString()),e},0);break;default:return e.emit("error",new Error("Invalid property "+t+": "+r)),!1}return n}if(t)for(var i in t){var o=0,s=0,a=t[i];if(Array.isArray(a))for(var c=0;c<a.length;c++){if(!(s=n(i,a[c])))return!1;o+=s}else{if(!(s=n(i,a)))return!1;o=s}if(!o)return!1;r+=o}return{length:$n(r).length+r,write:function(){li(e,t,r)}}}function ci(e,t,r,n){var i=["reasonString","userProperties"],o=r&&r.properties&&r.properties.maximumPacketSize?r.properties.maximumPacketSize:0,s=ai(e,t);if(o)for(;n+s.length>o;){var a=i.shift();if(!a||!t[a])return!1;delete t[a],s=ai(e,t)}return s}function ui(e,t,r){switch(kn.propertiesTypes[t]){case"byte":e.write(Fn.from([kn.properties[t]])),e.write(Fn.from([+r]));break;case"int8":e.write(Fn.from([kn.properties[t]])),e.write(Fn.from([r]));break;case"binary":e.write(Fn.from([kn.properties[t]])),si(e,r);break;case"int16":e.write(Fn.from([kn.properties[t]])),Gn(e,r);break;case"int32":e.write(Fn.from([kn.properties[t]])),function(e,t){var n=Zn(r);Hn("write4ByteNumber: %o",n),e.write(n)}(e);break;case"var":e.write(Fn.from([kn.properties[t]])),ti(e,r);break;case"string":e.write(Fn.from([kn.properties[t]])),ri(e,r);break;case"pair":Object.getOwnPropertyNames(r).forEach(function(n){var i=r[n];Array.isArray(i)?i.forEach(function(r){e.write(Fn.from([kn.properties[t]])),ni(e,n.toString(),r.toString())}):(e.write(Fn.from([kn.properties[t]])),ni(e,n.toString(),i.toString()))});break;default:return e.emit("error",new Error("Invalid property "+t+" value: "+r)),!1}}function li(e,t,r){for(var n in ti(e,r),t)if(t.hasOwnProperty(n)&&null!==t[n]){var i=t[n];if(Array.isArray(i))for(var o=0;o<i.length;o++)ui(e,n,i[o]);else ui(e,n,i)}}function hi(e){return e?e instanceof Fn?e.length:Fn.byteLength(e):0}function fi(e){return"string"==typeof e||e instanceof Fn}var pi=Yn,di=re.Buffer,gi=l.EventEmitter;function yi(){this._array=new Array(20),this._i=0}ue(yi,gi),yi.prototype.write=function(e){return this._array[this._i++]=e,!0},yi.prototype.concat=function(){var e,t,r=0,n=new Array(this._array.length),i=this._array,o=0;for(e=0;e<i.length&&void 0!==i[e];e++)"string"!=typeof i[e]?n[e]=i[e].length:n[e]=di.byteLength(i[e]),r+=n[e];for(t=di.allocUnsafe(r),e=0;e<i.length&&void 0!==i[e];e++)"string"!=typeof i[e]?(i[e].copy(t,o),o+=n[e]):(t.write(i[e],o),o+=n[e]);return t};var _i={};function bi(e,t,r){var n=this;this._callback=e,this._args=r,this._interval=setInterval(e,t,this._args),this.reschedule=function(e){e||(e=n._interval),n._interval&&clearInterval(n._interval),n._interval=setInterval(n._callback,e,n._args)},this.clear=function(){n._interval&&(clearInterval(n._interval),n._interval=void 0)},this.destroy=function(){n._interval&&clearInterval(n._interval),n._callback=void 0,n._interval=void 0,n._args=void 0}}_i.parser=jn,_i.writeToStream=pi;function mi(e){for(var t=e.split("/"),r=0;r<t.length;r++)if("+"!==t[r]){if("#"===t[r])return r===t.length-1;if(-1!==t[r].indexOf("+")||-1!==t[r].indexOf("#"))return!1}return!0}var vi=function(e){if(0===e.length)return"empty_topic_list";for(var t=0;t<e.length;t++)if(!mi(e[t]))return e[t];return null},wi={};(function(e,t){"use strict";var r=l.EventEmitter,n=Ce.Writable,i=xn("mqttjs:client"),o=t.setImmediate||function(t){e.nextTick(t)},s={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0},a=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND"],c={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};function u(e,t,r){i("sendPacket :: packet: %O",t),i("sendPacket :: emitting `packetsend`"),e.emit("packetsend",t),i("sendPacket :: writing to stream");var n=_i.writeToStream(t,e.stream,e.options);i("sendPacket :: writeToStream result %s",n),!n&&r?(i("sendPacket :: handle events on `drain` once through callback."),e.stream.once("drain",r)):r&&(i("sendPacket :: invoking cb"),r())}function h(e,t,r,n){i("storeAndSend :: store packet with cmd %s to outgoingStore",t.cmd),e.outgoingStore.put(t,function(i){if(i)return r&&r(i);n(),u(e,t,r)})}function f(e){i("nop ::",e)}function p(e,t){var n,o=this;if(!(this instanceof p))return new p(e,t);for(n in this.options=t||{},s)void 0===this.options[n]?this.options[n]=s[n]:this.options[n]=t[n];i("MqttClient :: options.protocol",t.protocol),i("MqttClient :: options.protocolVersion",t.protocolVersion),i("MqttClient :: options.username",t.username),i("MqttClient :: options.keepalive",t.keepalive),i("MqttClient :: options.reconnectPeriod",t.reconnectPeriod),i("MqttClient :: options.rejectUnauthorized",t.rejectUnauthorized),this.options.clientId="string"==typeof t.clientId?t.clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),i("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=5===t.protocolVersion&&t.customHandleAcks?t.customHandleAcks:function(){arguments[3](0)},this.streamBuilder=e,this.outgoingStore=t.outgoingStore||new gn,this.incomingStore=t.incomingStore||new gn,this.queueQoSZero=void 0===t.queueQoSZero||t.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this.nextId=Math.max(1,Math.floor(65535*Math.random())),this.outgoing={},this._firstConnection=!0,this.on("connect",function(){var e=this.queue;i("connect :: sending queued packets"),function t(){var r,n=e.shift();i("deliver :: entry %o",n),n&&(r=n.packet,i("deliver :: call _sendPacket for %o",r),o._sendPacket(r,function(e){n.cb&&n.cb(e),t()}))}()}),this.on("close",function(){i("close :: connected set to `false`"),this.connected=!1,i("close :: clearing connackTimer"),clearTimeout(this.connackTimer),i("close :: clearing ping timer"),null!==o.pingTimer&&(o.pingTimer.clear(),o.pingTimer=null),i("close :: calling _setupReconnect"),this._setupReconnect()}),r.call(this),i("MqttClient :: setting up stream"),this._setupStream()}ue(p,r),p.prototype._setupStream=function(){var t,r=this,o=new n,s=_i.parser(this.options),c=null,l=[];function h(){if(l.length)e.nextTick(p);else{var t=c;c=null,t()}}function p(){i("work :: getting next packet in queue");var e=l.shift();if(e)i("work :: packet pulled from queue"),r._handlePacket(e,h);else{i("work :: no packets in queue");var t=c;c=null,i("work :: done flag is %s",!!t),t&&t()}}if(i("_setupStream :: calling method to clear reconnect"),this._clearReconnect(),i("_setupStream :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),s.on("packet",function(e){i("parser :: on packet push to packets array."),l.push(e)}),o._write=function(e,t,r){c=r,i("writable stream :: parsing buffer"),s.parse(e),p()},i("_setupStream :: pipe stream to writable stream"),this.stream.pipe(o),this.stream.on("error",function(e){i("streamErrorHandler :: error",e.message),a.includes(e.code)?(i("streamErrorHandler :: emitting error"),r.emit("error",e)):f(e)}),this.stream.on("close",function(){var e;i("(%s)stream :: on close",r.options.clientId),(e=r.outgoing)&&(i("flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(e).forEach(function(t){e[t].volatile&&"function"==typeof e[t].cb&&(e[t].cb(new Error("Connection closed")),delete e[t])})),i("stream: emit close to MqttClient"),r.emit("close")}),i("_setupStream: sending packet `connect`"),(t=Object.create(this.options)).cmd="connect",u(this,t),s.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return r.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;this.options.properties.authenticationMethod&&this.options.authPacket&&"object"==typeof this.options.authPacket&&u(this,O({cmd:"auth",reasonCode:0},this.options.authPacket))}this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(function(){i("!!connectTimeout hit!! Calling _cleanUp with force `true`"),r._cleanUp(!0)},this.options.connectTimeout)},p.prototype._handlePacket=function(e,t){var r=this.options;if(5===r.protocolVersion&&r.properties&&r.properties.maximumPacketSize&&r.properties.maximumPacketSize<e.length)return this.emit("error",new Error("exceeding packets size "+e.cmd)),this.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),this;switch(i("_handlePacket :: emitting packetreceive"),this.emit("packetreceive",e),e.cmd){case"publish":this._handlePublish(e,t);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":this._handleAck(e),t();break;case"pubrel":this._handlePubrel(e,t);break;case"connack":this._handleConnack(e),t();break;case"pingresp":this._handlePingresp(e),t();break;case"disconnect":this._handleDisconnect(e),t()}},p.prototype._checkDisconnecting=function(e){return this.disconnecting&&(e?e(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting},p.prototype.publish=function(e,t,r,n){var o;i("publish :: message `%s` to topic `%s`",t,e);var s=this.options;if("function"==typeof r&&(n=r,r=null),r=O({qos:0,retain:!1,dup:!1},r),this._checkDisconnecting(n))return this;switch(o={cmd:"publish",topic:e,payload:t,qos:r.qos,retain:r.retain,messageId:this._nextId(),dup:r.dup},5===s.protocolVersion&&(o.properties=r.properties,(!s.properties&&o.properties&&o.properties.topicAlias||r.properties&&s.properties&&(r.properties.topicAlias&&s.properties.topicAliasMaximum&&r.properties.topicAlias>s.properties.topicAliasMaximum||!s.properties.topicAliasMaximum&&r.properties.topicAlias))&&delete o.properties.topicAlias),i("publish :: qos",r.qos),r.qos){case 1:case 2:this.outgoing[o.messageId]={volatile:!1,cb:n||f},this._storeProcessing?(i("_storeProcessing enabled"),this._packetIdsDuringStoreProcessing[o.messageId]=!1,this._storePacket(o,void 0,r.cbStorePut)):(i("MqttClient:publish: packet cmd: %s",o.cmd),this._sendPacket(o,void 0,r.cbStorePut));break;default:this._storeProcessing?(i("_storeProcessing enabled"),this._storePacket(o,n,r.cbStorePut)):(i("MqttClient:publish: packet cmd: %s",o.cmd),this._sendPacket(o,n,r.cbStorePut))}return this},p.prototype.subscribe=function(){for(var e,t=new Array(arguments.length),r=0;r<arguments.length;r++)t[r]=arguments[r];var n,s=[],a=t.shift(),c=a.resubscribe,u=t.pop()||f,l=t.pop(),h=this,p=this.options.protocolVersion;if(delete a.resubscribe,"string"==typeof a&&(a=[a]),"function"!=typeof u&&(l=u,u=f),null!==(n=vi(a)))return o(u,new Error("Invalid topic "+n)),this;if(this._checkDisconnecting(u))return i("subscribe: discconecting true"),this;var d={qos:0};if(5===p&&(d.nl=!1,d.rap=!1,d.rh=0),l=O(d,l),Array.isArray(a)?a.forEach(function(e){if(i("subscribe: array topic %s",e),!h._resubscribeTopics.hasOwnProperty(e)||h._resubscribeTopics[e].qos<l.qos||c){var t={topic:e,qos:l.qos};5===p&&(t.nl=l.nl,t.rap=l.rap,t.rh=l.rh,t.properties=l.properties),i("subscribe: pushing topic `%s` and qos `%s` to subs list",t.topic,t.qos),s.push(t)}}):Object.keys(a).forEach(function(e){if(i("subscribe: object topic %s",e),!h._resubscribeTopics.hasOwnProperty(e)||h._resubscribeTopics[e].qos<a[e].qos||c){var t={topic:e,qos:a[e].qos};5===p&&(t.nl=a[e].nl,t.rap=a[e].rap,t.rh=a[e].rh,t.properties=l.properties),i("subscribe: pushing `%s` to subs list",t),s.push(t)}}),e={cmd:"subscribe",subscriptions:s,qos:1,retain:!1,dup:!1,messageId:this._nextId()},l.properties&&(e.properties=l.properties),s.length){if(this.options.resubscribe){i("subscribe :: resubscribe true");var g=[];s.forEach(function(e){if(h.options.reconnectPeriod>0){var t={qos:e.qos};5===p&&(t.nl=e.nl||!1,t.rap=e.rap||!1,t.rh=e.rh||0,t.properties=e.properties),h._resubscribeTopics[e.topic]=t,g.push(e.topic)}}),h.messageIdToTopic[e.messageId]=g}return this.outgoing[e.messageId]={volatile:!0,cb:function(e,t){if(!e)for(var r=t.granted,n=0;n<r.length;n+=1)s[n].qos=r[n];u(e,s)}},i("subscribe :: call _sendPacket"),this._sendPacket(e),this}u(null,[])},p.prototype.unsubscribe=function(){for(var e={cmd:"unsubscribe",qos:1,messageId:this._nextId()},t=this,r=new Array(arguments.length),n=0;n<arguments.length;n++)r[n]=arguments[n];var o=r.shift(),s=r.pop()||f,a=r.pop();return"string"==typeof o&&(o=[o]),"function"!=typeof s&&(a=s,s=f),this._checkDisconnecting(s)?this:("string"==typeof o?e.unsubscriptions=[o]:"object"==typeof o&&o.length&&(e.unsubscriptions=o),this.options.resubscribe&&e.unsubscriptions.forEach(function(e){delete t._resubscribeTopics[e]}),"object"==typeof a&&a.properties&&(e.properties=a.properties),this.outgoing[e.messageId]={volatile:!0,cb:s},i("unsubscribe: call _sendPacket"),this._sendPacket(e),this)},p.prototype.end=function(t,r,n){var o=this;function s(){i("end :: (%s) :: finish :: calling _cleanUp with force %s",o.options.clientId,t),o._cleanUp(t,()=>{i("end :: finish :: calling process.nextTick on closeStores"),e.nextTick(function(){i("end :: closeStores: closing incoming and outgoing stores"),o.disconnected=!0,o.incomingStore.close(function(){o.outgoingStore.close(function(){i("end :: closeStores: emitting end"),o.emit("end"),n&&(i("end :: closeStores: invoking callback with args"),n())})}),o._deferredReconnect&&o._deferredReconnect()}.bind(o))},r)}return i("end :: (%s)",this.options.clientId),null!=t&&"boolean"==typeof t||(n=r||f,r=t,t=!1,"object"!=typeof r&&(n=r,r=null,"function"!=typeof n&&(n=f))),"object"!=typeof r&&(n=r,r=null),i("end :: cb? %s",!!n),n=n||f,this.disconnecting?(n(),this):(this._clearReconnect(),this.disconnecting=!0,!t&&Object.keys(this.outgoing).length>0?(i("end :: (%s) :: calling finish in 10ms once outgoing is empty",o.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,s,10))):(i("end :: (%s) :: immediately calling finish",o.options.clientId),s()),this)},p.prototype.removeOutgoingMessage=function(e){var t=this.outgoing[e]?this.outgoing[e].cb:null;return delete this.outgoing[e],this.outgoingStore.del({messageId:e},function(){t(new Error("Message removed"))}),this},p.prototype.reconnect=function(e){i("client reconnect");var t=this,r=function(){e?(t.options.incomingStore=e.incomingStore,t.options.outgoingStore=e.outgoingStore):(t.options.incomingStore=null,t.options.outgoingStore=null),t.incomingStore=t.options.incomingStore||new gn,t.outgoingStore=t.options.outgoingStore||new gn,t.disconnecting=!1,t.disconnected=!1,t._deferredReconnect=null,t._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=r:r(),this},p.prototype._reconnect=function(){i("_reconnect: emitting reconnect to client"),this.emit("reconnect"),i("_reconnect: calling _setupStream"),this._setupStream()},p.prototype._setupReconnect=function(){var e=this;!e.disconnecting&&!e.reconnectTimer&&e.options.reconnectPeriod>0?(this.reconnecting||(i("_setupReconnect :: emit `offline` state"),this.emit("offline"),i("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),i("_setupReconnect :: setting reconnectTimer for %d ms",e.options.reconnectPeriod),e.reconnectTimer=setInterval(function(){i("reconnectTimer :: reconnect triggered!"),e._reconnect()},e.options.reconnectPeriod)):i("_setupReconnect :: doing nothing...")},p.prototype._clearReconnect=function(){i("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)},p.prototype._cleanUp=function(e,t){var r,n=arguments[2];if(t&&(i("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",t)),i("_cleanUp :: forced? %s",e),e)0===this.options.reconnectPeriod&&this.options.clean&&(r=this.outgoing)&&(i("flush: queue exists? %b",!!r),Object.keys(r).forEach(function(e){"function"==typeof r[e].cb&&(r[e].cb(new Error("Connection closed")),delete r[e])})),i("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{var s=O({cmd:"disconnect"},n);i("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(s,o.bind(null,this.stream.end.bind(this.stream)))}this.disconnecting||(i("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),null!==this.pingTimer&&(i("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),t&&!this.connected&&(i("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",t),t())},p.prototype._sendPacket=function(e,t,r){if(i("_sendPacket :: (%s) ::  start",this.options.clientId),r=r||f,!this.connected)return i("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(e,t,r);switch(this._shiftPingInterval(),e.cmd){case"publish":break;case"pubrel":return void h(this,e,t,r);default:return void u(this,e,t)}switch(e.qos){case 2:case 1:h(this,e,t,r);break;case 0:default:u(this,e,t)}i("_sendPacket :: (%s) ::  end",this.options.clientId)},p.prototype._storePacket=function(e,t,r){i("_storePacket :: packet: %o",e),i("_storePacket :: cb? %s",!!t),r=r||f,0===(e.qos||0)&&this.queueQoSZero||"publish"!==e.cmd?this.queue.push({packet:e,cb:t}):e.qos>0?(t=this.outgoing[e.messageId]?this.outgoing[e.messageId].cb:null,this.outgoingStore.put(e,function(e){if(e)return t&&t(e);r()})):t&&t(new Error("No connection to broker"))},p.prototype._setupPingTimer=function(){i("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive);var e=this;!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("interval needed");var e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new bi(arguments[0],arguments[1],e)}(function(){e._checkPing()},1e3*this.options.keepalive))},p.prototype._shiftPingInterval=function(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)},p.prototype._checkPing=function(){i("_checkPing :: checking ping..."),this.pingResp?(i("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(i("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))},p.prototype._handlePingresp=function(){this.pingResp=!0},p.prototype._handleConnack=function(e){i("_handleConnack");var t=this.options,r=5===t.protocolVersion?e.reasonCode:e.returnCode;if(clearTimeout(this.connackTimer),e.properties&&(e.properties.topicAliasMaximum&&(t.properties||(t.properties={}),t.properties.topicAliasMaximum=e.properties.topicAliasMaximum),e.properties.serverKeepAlive&&t.keepalive&&(t.keepalive=e.properties.serverKeepAlive,this._shiftPingInterval()),e.properties.maximumPacketSize&&(t.properties||(t.properties={}),t.properties.maximumPacketSize=e.properties.maximumPacketSize)),0===r)this.reconnecting=!1,this._onConnect(e);else if(r>0){var n=new Error("Connection refused: "+c[r]);n.code=r,this.emit("error",n)}},p.prototype._handlePublish=function(e,t){i("_handlePublish: packet %o",e),t=void 0!==t?t:f;var r=e.topic.toString(),n=e.payload,o=e.qos,s=e.messageId,a=this,c=this.options,u=[0,16,128,131,135,144,145,151,153];switch(i("_handlePublish: qos %d",o),o){case 2:c.customHandleAcks(r,n,e,function(r,n){return r instanceof Error||(n=r,r=null),r?a.emit("error",r):-1===u.indexOf(n)?a.emit("error",new Error("Wrong reason code for pubrec")):void(n?a._sendPacket({cmd:"pubrec",messageId:s,reasonCode:n},t):a.incomingStore.put(e,function(){a._sendPacket({cmd:"pubrec",messageId:s},t)}))});break;case 1:c.customHandleAcks(r,n,e,function(i,o){return i instanceof Error||(o=i,i=null),i?a.emit("error",i):-1===u.indexOf(o)?a.emit("error",new Error("Wrong reason code for puback")):(o||a.emit("message",r,n,e),void a.handleMessage(e,function(e){if(e)return t&&t(e);a._sendPacket({cmd:"puback",messageId:s,reasonCode:o},t)}))});break;case 0:this.emit("message",r,n,e),this.handleMessage(e,t);break;default:i("_handlePublish: unknown QoS. Doing nothing.")}},p.prototype.handleMessage=function(e,t){t()},p.prototype._handleAck=function(e){var t,r=e.messageId,n=e.cmd,o=null,s=this.outgoing[r]?this.outgoing[r].cb:null,a=this;if(s){switch(i("_handleAck :: packet type",n),n){case"pubcomp":case"puback":var u=e.reasonCode;u&&u>0&&16!==u&&((t=new Error("Publish error: "+c[u])).code=u,s(t,e)),delete this.outgoing[r],this.outgoingStore.del(e,s);break;case"pubrec":o={cmd:"pubrel",qos:2,messageId:r};var l=e.reasonCode;l&&l>0&&16!==l?((t=new Error("Publish error: "+c[l])).code=l,s(t,e)):this._sendPacket(o);break;case"suback":delete this.outgoing[r];for(var h=0;h<e.granted.length;h++)if(0!=(128&e.granted[h])){var f=this.messageIdToTopic[r];f&&f.forEach(function(e){delete a._resubscribeTopics[e]})}s(null,e);break;case"unsuback":delete this.outgoing[r],s(null);break;default:a.emit("error",new Error("unrecognized packet type"))}this.disconnecting&&0===Object.keys(this.outgoing).length&&this.emit("outgoingEmpty")}else i("_handleAck :: Server sent an ack in error. Ignoring.")},p.prototype._handlePubrel=function(e,t){i("handling pubrel packet"),t=void 0!==t?t:f;var r=e.messageId,n=this,o={cmd:"pubcomp",messageId:r};n.incomingStore.get(e,function(e,r){e?n._sendPacket(o,t):(n.emit("message",r.topic,r.payload,r),n.handleMessage(r,function(e){if(e)return t(e);n.incomingStore.del(r,f),n._sendPacket(o,t)}))})},p.prototype._handleDisconnect=function(e){this.emit("disconnect",e)},p.prototype._nextId=function(){var e=this.nextId++;return 65536===this.nextId&&(this.nextId=1),e},p.prototype.getLastMessageId=function(){return 1===this.nextId?65535:this.nextId-1},p.prototype._resubscribe=function(e){i("_resubscribe");var t=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||5===this.options.protocolVersion&&!e.sessionPresent)&&t.length>0)if(this.options.resubscribe)if(5===this.options.protocolVersion){i("_resubscribe: protocolVersion 5");for(var r=0;r<t.length;r++){var n={};n[t[r]]=this._resubscribeTopics[t[r]],n.resubscribe=!0,this.subscribe(n,{properties:n[t[r]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1},p.prototype._onConnect=function(e){if(this.disconnected)this.emit("connect",e);else{var t=this;this._setupPingTimer(),this._resubscribe(e),this.connected=!0,function r(){var n=t.outgoingStore.createStream();function i(){t._storeProcessing=!1,t._packetIdsDuringStoreProcessing={}}function o(){n.destroy(),n=null,i()}t.once("close",o),n.on("error",function(e){i(),t.removeListener("close",o),t.emit("error",e)}),n.on("end",function(){var n=!0;for(var s in t._packetIdsDuringStoreProcessing)if(!t._packetIdsDuringStoreProcessing[s]){n=!1;break}n?(i(),t.removeListener("close",o),t.emit("connect",e)):r()}),function e(){if(n){t._storeProcessing=!0;var r,i=n.read(1);i?t._packetIdsDuringStoreProcessing[i.messageId]?e():t.disconnecting||t.reconnectTimer?n.destroy&&n.destroy():(r=t.outgoing[i.messageId]?t.outgoing[i.messageId].cb:null,t.outgoing[i.messageId]={volatile:!1,cb:function(t,n){r&&r(t,n),e()}},t._packetIdsDuringStoreProcessing[i.messageId]=!0,t._sendPacket(i)):n.once("readable",e)}}()}()}},wi=p}).call(this,P,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Si={exports:{}};(function(e){!function(t){var r="object"==typeof Si.exports&&Si.exports&&!Si.exports.nodeType&&Si.exports,n=Si&&!Si.nodeType&&Si,i="object"==typeof e&&e;i.global!==i&&i.window!==i&&i.self!==i||(t=i);var o,s,a=2147483647,c=36,u=1,l=26,h=38,f=700,p=72,d=128,g="-",y=/^xn--/,_=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=c-u,w=Math.floor,S=String.fromCharCode;function k(e){throw new RangeError(m[e])}function E(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function I(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+E((e=e.replace(b,".")).split("."),t).join(".")}function C(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function O(e){return E(e,function(e){var t="";return e>65535&&(t+=S((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+S(e)}).join("")}function A(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function P(e,t,r){var n=0;for(e=r?w(e/f):e>>1,e+=w(e/t);e>v*l>>1;n+=c)e=w(e/v);return w(n+(v+1)*e/(e+h))}function T(e){var t,r,n,i,o,s,h,f,y,_,b,m=[],v=e.length,S=0,E=d,I=p;for((r=e.lastIndexOf(g))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&k("not-basic"),m.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<v;){for(o=S,s=1,h=c;i>=v&&k("invalid-input"),((f=(b=e.charCodeAt(i++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:c)>=c||f>w((a-S)/s))&&k("overflow"),S+=f*s,!(f<(y=h<=I?u:h>=I+l?l:h-I));h+=c)s>w(a/(_=c-y))&&k("overflow"),s*=_;I=P(S-o,t=m.length+1,0==o),w(S/t)>a-E&&k("overflow"),E+=w(S/t),S%=t,m.splice(S++,0,E)}return O(m)}function x(e){var t,r,n,i,o,s,h,f,y,_,b,m,v,E,I,O=[];for(m=(e=C(e)).length,t=d,r=0,o=p,s=0;s<m;++s)(b=e[s])<128&&O.push(S(b));for(n=i=O.length,i&&O.push(g);n<m;){for(h=a,s=0;s<m;++s)(b=e[s])>=t&&b<h&&(h=b);for(h-t>w((a-r)/(v=n+1))&&k("overflow"),r+=(h-t)*v,t=h,s=0;s<m;++s)if((b=e[s])<t&&++r>a&&k("overflow"),b==t){for(f=r,y=c;!(f<(_=y<=o?u:y>=o+l?l:y-o));y+=c)I=f-_,E=c-_,O.push(S(A(_+I%E,0))),f=w(I/E);O.push(S(A(f,0))),o=P(r,v,n==i),r=0,++n}++r,++t}return O.join("")}if(o={version:"1.4.1",ucs2:{decode:C,encode:O},decode:T,encode:x,toASCII:function(e){return I(e,function(e){return _.test(e)?"xn--"+x(e):e})},toUnicode:function(e){return I(e,function(e){return y.test(e)?T(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return o});else if(r&&n)if(Si.exports==r)n.exports=o;else for(s in o)o.hasOwnProperty(s)&&(r[s]=o[s]);else t.punycode=o}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),Si=Si.exports;var ki={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}};function Ei(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ii=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ci=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},Oi=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function Ai(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var Pi=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},Ti={parse:function(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a=e.length;s>0&&a>s&&(a=s);for(var c=0;c<a;++c){var u,l,h,f,p=e[c].replace(o,"%20"),d=p.indexOf(r);d>=0?(u=p.substr(0,d),l=p.substr(d+1)):(u=p,l=""),h=decodeURIComponent(u),f=decodeURIComponent(l),Ei(i,h)?Ii(i[h])?i[h].push(f):i[h]=[i[h],f]:i[h]=f}return i},stringify:function(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Ai(Pi(e),function(n){var i=encodeURIComponent(Ci(n))+r;return Oi(e[n])?Ai(e[n],function(e){return i+encodeURIComponent(Ci(e))}).join(t):i+encodeURIComponent(Ci(e[n]))}).join(t):n?encodeURIComponent(Ci(n))+r+encodeURIComponent(Ci(e)):""}},xi={};function ji(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}xi.parse=Ki;var Mi=/^([a-z0-9.+-]+:)/i,Bi=/:[0-9]*$/,Ri=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Ui=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Ni=["'"].concat(Ui),Li=["%","/","?",";","#"].concat(Ni),qi=["/","?","#"],Fi=/^[+a-z0-9A-Z_-]{0,63}$/,Di=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,zi={javascript:!0,"javascript:":!0},Wi={javascript:!0,"javascript:":!0},Hi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Ki(e,t,r){if(e&&ki.isObject(e)&&e instanceof ji)return e;var n=new ji;return n.parse(e,t,r),n}ji.prototype.parse=function(e,t,r){if(!ki.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),i=-1!==n&&n<e.indexOf("#")?"?":"#",o=e.split(i);o[0]=o[0].replace(/\\/g,"/");var s=e=o.join(i);if(s=s.trim(),!r&&1===e.split("#").length){var a=Ri.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=t?Ti.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var c=Mi.exec(s);if(c){var u=(c=c[0]).toLowerCase();this.protocol=u,s=s.substr(c.length)}if(r||c||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===s.substr(0,2);!l||c&&Wi[c]||(s=s.substr(2),this.slashes=!0)}if(!Wi[c]&&(l||c&&!Hi[c])){for(var h,f,p=-1,d=0;d<qi.length;d++)-1!==(g=s.indexOf(qi[d]))&&(-1===p||g<p)&&(p=g);for(-1!==(f=-1===p?s.lastIndexOf("@"):s.lastIndexOf("@",p))&&(h=s.slice(0,f),s=s.slice(f+1),this.auth=decodeURIComponent(h)),p=-1,d=0;d<Li.length;d++){var g;-1!==(g=s.indexOf(Li[d]))&&(-1===p||g<p)&&(p=g)}-1===p&&(p=s.length),this.host=s.slice(0,p),s=s.slice(p),this.parseHost(),this.hostname=this.hostname||"";var y="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!y)for(var _=this.hostname.split(/\./),b=(d=0,_.length);d<b;d++){var m=_[d];if(m&&!m.match(Fi)){for(var v="",w=0,S=m.length;w<S;w++)m.charCodeAt(w)>127?v+="x":v+=m[w];if(!v.match(Fi)){var k=_.slice(0,d),E=_.slice(d+1),I=m.match(Di);I&&(k.push(I[1]),E.unshift(I[2])),E.length&&(s="/"+E.join(".")+s),this.hostname=k.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Si.toASCII(this.hostname));var C=this.port?":"+this.port:"",O=this.hostname||"";this.host=O+C,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!zi[u])for(d=0,b=Ni.length;d<b;d++){var A=Ni[d];if(-1!==s.indexOf(A)){var P=encodeURIComponent(A);P===A&&(P=escape(A)),s=s.split(A).join(P)}}var T=s.indexOf("#");-1!==T&&(this.hash=s.substr(T),s=s.slice(0,T));var x=s.indexOf("?");if(-1!==x?(this.search=s.substr(x),this.query=s.substr(x+1),t&&(this.query=Ti.parse(this.query)),s=s.slice(0,x)):t&&(this.search="",this.query={}),s&&(this.pathname=s),Hi[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){C=this.pathname||"";var j=this.search||"";this.path=C+j}return this.href=this.format(),this},ji.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&ki.isObject(this.query)&&Object.keys(this.query).length&&(o=Ti.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||Hi[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+i+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+n},ji.prototype.resolve=function(e){return this.resolveObject(Ki(e,!1,!0)).format()},ji.prototype.resolveObject=function(e){if(ki.isString(e)){var t=new ji;t.parse(e,!1,!0),e=t}for(var r=new ji,n=Object.keys(this),i=0;i<n.length;i++){var o=n[i];r[o]=this[o]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),a=0;a<s.length;a++){var c=s[a];"protocol"!==c&&(r[c]=e[c])}return Hi[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!Hi[e.protocol]){for(var u=Object.keys(e),l=0;l<u.length;l++){var h=u[l];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||Wi[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",d=r.search||"";r.path=p+d}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=y||g||r.host&&e.pathname,b=_,m=r.pathname&&r.pathname.split("/")||[],v=(f=e.pathname&&e.pathname.split("/")||[],r.protocol&&!Hi[r.protocol]);if(v&&(r.hostname="",r.port=null,r.host&&(""===m[0]?m[0]=r.host:m.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),_=_&&(""===f[0]||""===m[0])),y)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,m=f;else if(f.length)m||(m=[]),m.pop(),m=m.concat(f),r.search=e.search,r.query=e.query;else if(!ki.isNullOrUndefined(e.search))return v&&(r.hostname=r.host=m.shift(),(I=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=I.shift(),r.host=r.hostname=I.shift())),r.search=e.search,r.query=e.query,ki.isNull(r.pathname)&&ki.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!m.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var w=m.slice(-1)[0],S=(r.host||e.host||m.length>1)&&("."===w||".."===w)||""===w,k=0,E=m.length;E>=0;E--)"."===(w=m[E])?m.splice(E,1):".."===w?(m.splice(E,1),k++):k&&(m.splice(E,1),k--);if(!_&&!b)for(;k--;k)m.unshift("..");!_||""===m[0]||m[0]&&"/"===m[0].charAt(0)||m.unshift(""),S&&"/"!==m.join("/").substr(-1)&&m.push("");var I,C=""===m[0]||m[0]&&"/"===m[0].charAt(0);return v&&(r.hostname=r.host=C?"":m.length?m.shift():"",(I=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=I.shift(),r.host=r.hostname=I.shift())),(_=_||r.host&&m.length)&&!C&&m.unshift(""),m.length?r.pathname=m.join("/"):(r.pathname=null,r.path=null),ki.isNull(r.pathname)&&ki.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},ji.prototype.parseHost=function(){var e=this.host,t=Bi.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};var Vi=xn("mqttjs:tcp"),Qi=function(e,t){var r,n;return t.port=t.port||1883,t.hostname=t.hostname||t.host||"localhost",r=t.port,n=t.hostname,Vi("port %d and host %s",r,n),le.createConnection(r,n)},$i=xn("mqttjs:tls"),Zi=function(e,t){var r;function n(n){t.rejectUnauthorized&&e.emit("error",n),r.end()}return t.port=t.port||8883,t.host=t.hostname||t.host||"localhost",t.servername=t.host,t.rejectUnauthorized=!1!==t.rejectUnauthorized,delete t.path,$i("port %d host %s rejectUnauthorized %b",t.port,t.host,t.rejectUnauthorized),(r=le.connect(t)).on("secureConnect",function(){t.rejectUnauthorized&&!r.authorized?r.emit("error",new Error("TLS not authorized")):r.removeListener("error",n)}),r.on("error",n),r},Gi=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){n[e]=t[e]}),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(e){n[e]=i[e]}),n}},Ji={};function Yi(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function Xi(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}(Ji=Gi(Yi)).strict=Gi(Xi),Yi.proto=Yi(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Yi(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Xi(this)},configurable:!0})});var eo={};(function(e){var t=function(){},r=function(n,i,o){if("function"==typeof i)return r(n,null,i);i||(i={}),o=Ji(o||t);var s=n._writableState,a=n._readableState,c=i.readable||!1!==i.readable&&n.readable,u=i.writable||!1!==i.writable&&n.writable,l=!1,h=function(){n.writable||f()},f=function(){u=!1,c||o.call(n)},p=function(){c=!1,u||o.call(n)},d=function(e){o.call(n,e?new Error("exited with error code: "+e):null)},g=function(e){o.call(n,e)},y=function(){e.nextTick(_)},_=function(){if(!l)return(!c||a&&a.ended&&!a.destroyed)&&(!u||s&&s.ended&&!s.destroyed)?void 0:o.call(n,new Error("premature close"))},b=function(){n.req.on("finish",f)};return function(e){return e.setHeader&&"function"==typeof e.abort}(n)?(n.on("complete",f),n.on("abort",y),n.req?b():n.on("request",b)):u&&!s&&(n.on("end",h),n.on("close",h)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(n)&&n.on("exit",d),n.on("end",p),n.on("finish",f),!1!==i.error&&n.on("error",g),n.on("close",y),function(){l=!0,n.removeListener("complete",f),n.removeListener("abort",y),n.removeListener("request",b),n.req&&n.req.removeListener("finish",f),n.removeListener("end",h),n.removeListener("close",h),n.removeListener("finish",f),n.removeListener("exit",d),n.removeListener("end",p),n.removeListener("error",g),n.removeListener("close",y)}};eo=r}).call(this,P);var to={};(function(e,t){var r=t.from&&t.from!==Uint8Array.from?t.from([0]):new t([0]),n=function(e,t){e._corked?e.once("uncork",t):t()},i=function(e,t){return function(r){r?function(e,t){e._autoDestroy&&e.destroy(t)}(e,"premature close"===r.message?null:r):t&&!e._ended&&e.end()}},o=function(e,t,r){if(!(this instanceof o))return new o(e,t,r);Ce.Duplex.call(this,r),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!r||!1!==r.autoDestroy,this._forwardDestroy=!r||!1!==r.destroy,this._forwardEnd=!r||!1!==r.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)};ue(o,Ce.Duplex),o.obj=function(e,t,r){return r||(r={}),r.objectMode=!0,r.highWaterMark=16,new o(e,t,r)},o.prototype.cork=function(){1==++this._corked&&this.emit("cork")},o.prototype.uncork=function(){this._corked&&0==--this._corked&&this.emit("uncork")},o.prototype.setWritable=function(t){if(this._unwrite&&this._unwrite(),this.destroyed)t&&t.destroy&&t.destroy();else if(null!==t&&!1!==t){var r=this,n=eo(t,{writable:!0,readable:!1},i(this,this._forwardEnd)),o=function(){var e=r._ondrain;r._ondrain=null,e&&e()};this._unwrite&&e.nextTick(o),this._writable=t,this._writable.on("drain",o),this._unwrite=function(){r._writable.removeListener("drain",o),n()},this.uncork()}else this.end()},o.prototype.setReadable=function(e){if(this._unread&&this._unread(),this.destroyed)e&&e.destroy&&e.destroy();else{if(null===e||!1===e)return this.push(null),void this.resume();var t,r=this,n=eo(e,{writable:!1,readable:!0},i(this)),o=function(){r._forward()},s=function(){r.push(null)};this._drained=!0,this._readable=e,this._readable2=e._readableState?e:(t=e,new Ce.Readable({objectMode:!0,highWaterMark:16}).wrap(t)),this._readable2.on("readable",o),this._readable2.on("end",s),this._unread=function(){r._readable2.removeListener("readable",o),r._readable2.removeListener("end",s),n()},this._forward()}},o.prototype._read=function(){this._drained=!0,this._forward()},o.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var e;for(this._forwarding=!0;this._drained&&null!==(t=this._readable2,r=void 0,n=void 0,e=(n=t._readableState)?n.objectMode||"number"==typeof t._duplexState?t.read():t.read((r=n).buffer.length?r.buffer.head?r.buffer.head.data.length:r.buffer[0].length:r.length):null);)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}var t,r,n},o.prototype.destroy=function(t){if(!this.destroyed){this.destroyed=!0;var r=this;e.nextTick(function(){r._destroy(t)})}},o.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null,t?t(e):this.emit("error",e)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},o.prototype._write=function(e,t,i){return this.destroyed?i():this._corked?n(this,this._write.bind(this,e,t,i)):e===r?this._finish(i):this._writable?void(!1===this._writable.write(e)?this._ondrain=i:i()):i()},o.prototype._finish=function(e){var t=this;this.emit("preend"),n(this,function(){var r,i;i=function(){!1===t._writableState.prefinished&&(t._writableState.prefinished=!0),t.emit("prefinish"),n(t,e)},(r=t._forwardEnd&&t._writable)?r._writableState&&r._writableState.finished?i():r._writableState?r.end(i):(r.end(),i()):i()})},o.prototype.end=function(e,t,n){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this.write(r),Ce.Writable.prototype.end.call(this,n))},to=o}).call(this,P,u({}).Buffer);var ro={};(function(e,t){"use strict";var r,n,i,o=Ce.Transform;ro=function(s,a){if(a.hostname=a.hostname||a.host,!a.hostname)throw new Error("Could not determine host. Specify host manually.");var c="MQIsdp"===a.protocolId&&3===a.protocolVersion?"mqttv3.1":"mqtt";!function(e){e.hostname||(e.hostname="localhost"),e.path||(e.path="/"),e.wsOptions||(e.wsOptions={})}(a);var u=function(e,t){var r="wxs"===e.protocol?"wss":"ws",n=r+"://"+e.hostname+e.path;return e.port&&80!==e.port&&443!==e.port&&(n=r+"://"+e.hostname+":"+e.port+e.path),"function"==typeof e.transformWsUrl&&(n=e.transformWsUrl(n,e,t)),n}(a,s);r=wx.connectSocket({url:u,protocols:c}),n=function(){var e=new o;return e._write=function(e,t,n){r.send({data:e.buffer,success:function(){n()},fail:function(e){n(new Error(e))}})},e._flush=function(e){r.close({success:function(){e()}})},e}(),(i=to.obj())._destroy=function(e,t){r.close({success:function(){t&&t(e)}})};var l=i.destroy;return i.destroy=function(){i.destroy=l;var t=this;e.nextTick(function(){r.close({fail:function(){t._destroy(new Error)}})})}.bind(i),r.onOpen(function(){i.setReadable(n),i.setWritable(n),i.emit("connect")}),r.onMessage(function(e){var r=e.data;r=r instanceof ArrayBuffer?t.from(r):t.from(r,"utf8"),n.push(r)}),r.onClose(function(){i.end(),i.destroy()}),r.onError(function(e){i.destroy(new Error(e.errMsg))}),i}}).call(this,P,u({}).Buffer);var no={};(function(e){"use strict";var t,r,n,i=Ce.Transform,o=!1;no=function(s,a){if(a.hostname=a.hostname||a.host,!a.hostname)throw new Error("Could not determine host. Specify host manually.");var c="MQIsdp"===a.protocolId&&3===a.protocolVersion?"mqttv3.1":"mqtt";!function(e){e.hostname||(e.hostname="localhost"),e.path||(e.path="/"),e.wsOptions||(e.wsOptions={})}(a);var u=function(e,t){var r="alis"===e.protocol?"wss":"ws",n=r+"://"+e.hostname+e.path;return e.port&&80!==e.port&&443!==e.port&&(n=r+"://"+e.hostname+":"+e.port+e.path),"function"==typeof e.transformWsUrl&&(n=e.transformWsUrl(n,e,t)),n}(a,s);return(t=a.my).connectSocket({url:u,protocols:c}),r=function(){var e=new i;return e._write=function(e,r,n){t.sendSocketMessage({data:e.buffer,success:function(){n()},fail:function(){n(new Error)}})},e._flush=function(e){t.closeSocket({success:function(){e()}})},e}(),n=to.obj(),o||(o=!0,t.onSocketOpen(function(){n.setReadable(r),n.setWritable(r),n.emit("connect")}),t.onSocketMessage(function(t){if("string"==typeof t.data){var n=V.toByteArray(t.data),i=e.from(n);r.push(i)}else{var o=new FileReader;o.addEventListener("load",function(){var t=o.result;t=t instanceof ArrayBuffer?e.from(t):e.from(t,"utf8"),r.push(t)}),o.readAsArrayBuffer(t.data)}}),t.onSocketClose(function(){n.end(),n.destroy()}),t.onSocketError(function(e){n.destroy(e)})),n}}).call(this,u({}).Buffer);var io={},oo=null;"undefined"!=typeof WebSocket?oo=WebSocket:"undefined"!=typeof MozWebSocket?oo=MozWebSocket:"undefined"!=typeof window&&(oo=window.WebSocket||window.MozWebSocket),io=oo;var so={};(function(e,t){"use strict";var r=Ce.Transform,n=re.Buffer;so=function(i,o,s){var a,c,u="browser"===e.title,l=!!t.WebSocket,h=u?function e(t,r,i){if(c.bufferedAmount>p)setTimeout(e,d,t,r,i);else{y&&"string"==typeof t&&(t=n.from(t,"utf8"));try{c.send(t)}catch(fo){return i(fo)}i()}}:function(e,t,r){c.readyState===c.OPEN?(y&&"string"==typeof e&&(e=n.from(e,"utf8")),c.send(e,r)):r()};o&&!Array.isArray(o)&&"object"==typeof o&&(s=o,o=null,("string"==typeof s.protocol||Array.isArray(s.protocol))&&(o=s.protocol)),s||(s={}),void 0===s.objectMode&&(s.objectMode=!(!0===s.binary||void 0===s.binary));var f=function(e,t,n){var i=new r({objectMode:e.objectMode});return i._write=t,i._flush=function(e){c.close(),e()},i}(s,h);s.objectMode||(f._writev=w);var p=s.browserBufferSize||524288,d=s.browserBufferTimeout||1e3;"object"==typeof i?c=i:(c=l&&u?new io(i,o):new io(i,o,s)).binaryType="arraybuffer";var g=void 0===c.addEventListener;c.readyState===c.OPEN?a=f:(a=a=to(void 0,void 0,s),s.objectMode||(a._writev=w),g?c.addEventListener("open",_):c.onopen=_),a.socket=c,g?(c.addEventListener("close",b),c.addEventListener("error",m),c.addEventListener("message",v)):(c.onclose=b,c.onerror=m,c.onmessage=v),f.on("close",function(){c.close()});var y=!s.objectMode;function _(){a.setReadable(f),a.setWritable(f),a.emit("connect")}function b(){a.end(),a.destroy()}function m(e){a.destroy(e)}function v(e){var t=e.data;t=t instanceof ArrayBuffer?n.from(t):n.from(t,"utf8"),f.push(t)}function w(e,t){for(var r=new Array(e.length),i=0;i<e.length;i++)"string"==typeof e[i].chunk?r[i]=n.from(e[i],"utf8"):r[i]=e[i].chunk;this._write(n.concat(r),"binary",t)}return a}}).call(this,P,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var ao={};(function(e){"use strict";var t=xn("mqttjs:ws"),r=["rejectUnauthorized","ca","cert","key","pfx","passphrase"],n="browser"===e.title;function i(e,i){t("createWebSocket");var o="MQIsdp"===i.protocolId&&3===i.protocolVersion?"mqttv3.1":"mqtt";!function(e){e.hostname||(e.hostname="localhost"),e.port||("wss"===e.protocol?e.port=443:e.port=80),e.path||(e.path="/"),e.wsOptions||(e.wsOptions={}),n||"wss"!==e.protocol||r.forEach(function(t){e.hasOwnProperty(t)&&!e.wsOptions.hasOwnProperty(t)&&(e.wsOptions[t]=e[t])})}(i);var s=function(e,t){var r=e.protocol+"://"+e.hostname+":"+e.port+e.path;return"function"==typeof e.transformWsUrl&&(r=e.transformWsUrl(r,e,t)),r}(i,e);return t("url %s protocol %s",s,o),so(s,[o],i.wsOptions)}ao=n?function(e,r){if(t("browserStreamBuilder"),r.hostname||(r.hostname=r.host),!r.hostname){if("undefined"==typeof document)throw new Error("Could not determine host. Specify host manually.");var n=xi.parse(document.URL);r.hostname=n.hostname,r.port||(r.port=n.port)}return i(e,r)}:function(e,t){return i(e,t)}}).call(this,P);var co={};(function(e){"use strict";var t=xn("mqttjs"),r={};function n(e,n){if(t("connecting to an MQTT broker..."),"object"!=typeof e||n||(n=e,e=null),n=n||{},e){var i=xi.parse(e,!0);if(null!=i.port&&(i.port=Number(i.port)),null===(n=O(i,n)).protocol)throw new Error("Missing protocol");n.protocol=n.protocol.replace(/:$/,"")}if(function(e){var t;e.auth&&((t=e.auth.match(/^(.+):(.+)$/))?(e.username=t[1],e.password=t[2]):e.username=e.auth)}(n),n.query&&"string"==typeof n.query.clientId&&(n.clientId=n.query.clientId),n.cert&&n.key){if(!n.protocol)throw new Error("Missing secure protocol key");if(-1===["mqtts","wss","wxs","alis"].indexOf(n.protocol))switch(n.protocol){case"mqtt":n.protocol="mqtts";break;case"ws":n.protocol="wss";break;case"wx":n.protocol="wxs";break;case"ali":n.protocol="alis";break;default:throw new Error('Unknown protocol for secure connection: "'+n.protocol+'"!')}}if(!r[n.protocol]){var o=-1!==["mqtts","wss"].indexOf(n.protocol);n.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter(function(e,t){return(!o||t%2!=0)&&"function"==typeof r[e]})[0]}if(!1===n.clean&&!n.clientId)throw new Error("Missing clientId for unclean clients");n.protocol&&(n.defaultProtocol=n.protocol);var s=new wi(function(e){return n.servers&&(e._reconnectCount&&e._reconnectCount!==n.servers.length||(e._reconnectCount=0),n.host=n.servers[e._reconnectCount].host,n.port=n.servers[e._reconnectCount].port,n.protocol=n.servers[e._reconnectCount].protocol?n.servers[e._reconnectCount].protocol:n.defaultProtocol,n.hostname=n.host,e._reconnectCount++),t("calling streambuilder for",n.protocol),r[n.protocol](e,n)},n);return s.on("error",function(){}),s}"browser"!==e.title?(r.mqtt=Qi,r.tcp=Qi,r.ssl=Zi,r.tls=Zi,r.mqtts=Zi):(r.wx=ro,r.wxs=ro,r.ali=no,r.alis=no),r.ws=ao,r.wss=ao,(co=n).connect=n,co.MqttClient=wi,co.Store=gn}).call(this,P);var uo={apiFetch:function(e,t,r={}){let n="";const i=r.body instanceof FormData;if("object"!=typeof r.body||i||(r.body=JSON.stringify(r.body)),r.query){const e=new URLSearchParams;Object.keys(r.query).forEach(t=>{void 0!==r.query[t]&&e.append(t,r.query[t])}),n=`?${e.toString()}`}return Object.assign(r,{credentials:"include"}),i||(r.headers={"Content-Type":"application/json",...r.headers}),async function(e,t){const r=await fetch(e,t);let n;if(n=(r.headers.get("content-type")||"").startsWith("application/json")?await r.json():r.text(),r.status>=400){const e=new Error("Bad response from server");throw e.status=r.status,e.content=n,e}return n}(`${r.api_url||e}${t}${n}`,r)}};const{apiFetch:lo}=uo;var ho={createClient:function({apiUrl:e="",API_URL:t="",appName:r="",wsUrl:n=""}){let i;if(!e&&!t&&!r)throw new Error("must have an apiURL, API_URL, or appName");if((e=e||t)||(e=`https://a.diyapis.com/${r}`),r||(r=e.split("/")[e.split("/").length-1]),!n){const t=new URL(e);n=`${"https:"===t.protocol?"wss:":"ws:"}//${t.host}/${r}`}const o={apiUrl:e,wsUrl:n,apiFetch:(t,r)=>lo(e,t,r),connect:(e,t={})=>(e=e||n,t={username:r,...t},i=co.connect(n,t),o.mqttClient=i,i.on("message",(e,t)=>{try{t=JSON.parse(t.toString()),i.emit("json",e,t)}catch(fo){}}),i),on:(...e)=>{if(i)return i.on(...e)},publish:(e,t,...r)=>{if(i)return t="object"==typeof t?JSON.stringify(t):String(t),i.publish(e,t,...r)},subscribe:(...e)=>{if(i)return i.subscribe(...e)},unsubscribe:(...e)=>{if(i)return i.unsubscribe(...e)},close:(...e)=>{if(i)return i.close(...e)},oauthStart:()=>o.apiFetch("/users/oauth_start"),tokenLogin:e=>o.apiFetch("/users/oauth_token",{method:"POST",body:{token:e}}),verifyUser:()=>o.apiFetch("/users/me")};return o}};(function(e){e.diyapis=ho}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}();